<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Kilesa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Kilesa">
<meta property="og:url" content="https://gitee.com/kilesa/kilesa/page/4/index.html">
<meta property="og:site_name" content="Kilesa">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="鱼糕先生">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Kilesa</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">文章</a>
        
      </nav>
      <nav id="sub-nav">
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Docker的基本使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/12/Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2021-03-12T05:51:54.000Z" itemprop="datePublished">2021-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/12/Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">Docker的基本使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、安装docker"><a href="#一、安装docker" class="headerlink" title="一、安装docker"></a>一、安装docker</h2><p>1.卸载旧版本</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure>

<p>2.安装<code>yum-utils</code>软件包，并设置储存库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这里用的是阿里云的镜像库</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<p>3.更新yum软件包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>

<p>4.安装docker   <code>docker-ce</code> 社区 <code>docker-ee</code> 企业</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装最新版本</span></span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">获取可以安装的版本</span></span><br><span class="line">yum list docker-ce --showduplicates | sort -r</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装指定的版本</span></span><br><span class="line">yum install docker-ce-版本号 docker-ce-cli-版本号 containerd.io</span><br></pre></td></tr></table></figure>

<h2 id="二、启动docker"><a href="#二、启动docker" class="headerlink" title="二、启动docker"></a>二、启动docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动docker服务器</span></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过运行hello-world 映像来验证是否正确安装了Docker</span></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>

<h2 id="三、卸载docker"><a href="#三、卸载docker" class="headerlink" title="三、卸载docker"></a>三、卸载docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">卸载Docker Engine，CLI和Containerd软件包</span></span><br><span class="line">sudo yum remove docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主机上的映像，容器，卷或自定义配置文件不会自动删除。要删除所有图像，容器和卷</span></span><br><span class="line">sudo rm -rf /var/lib/docker</span><br><span class="line">sudo rm -rf /var/lib/containerd</span><br></pre></td></tr></table></figure>

<blockquote>
<h6 id="还可以使用阿里云镜像加速"><a href="#还可以使用阿里云镜像加速" class="headerlink" title="还可以使用阿里云镜像加速"></a>还可以使用<a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">阿里云镜像加速</a></h6></blockquote>
<h2 id="四、docker的基本命令"><a href="#四、docker的基本命令" class="headerlink" title="四、docker的基本命令"></a>四、docker的基本命令</h2><h4 id="1-docker的帮助命令"><a href="#1-docker的帮助命令" class="headerlink" title="1.docker的帮助命令"></a>1.docker的帮助命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version  #显示docker的版本信息</span><br><span class="line">docker info #显示docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker 命令 --help # 帮助命令</span><br></pre></td></tr></table></figure>

<h4 id="2-镜像命令"><a href="#2-镜像命令" class="headerlink" title="2.镜像命令"></a>2.镜像命令</h4><h6 id="查看本地镜像"><a href="#查看本地镜像" class="headerlink" title="查看本地镜像"></a>查看本地镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker images #查看所有本地主机的镜像</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">REPOSIIORY 镜像的仓库源</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">TAG        镜像的标签</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">IMAGE ID   镜像的<span class="built_in">id</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">CREATED    镜像的创建时间</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">SIZE       镜像的大小</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可以用 docker images -aq</span></span><br><span class="line">docker images -a   docker images -all  #列出所有的镜像</span><br><span class="line">docker images -q   docker images -quiet#只显示镜像的id</span><br></pre></td></tr></table></figure>

<h6 id="搜索镜像"><a href="#搜索镜像" class="headerlink" title="搜索镜像"></a>搜索镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker search mysql  #搜索镜像</span><br><span class="line"></span><br><span class="line">docker search mysql --filter=STARS=300  #搜索STARS大于3000的镜像</span><br></pre></td></tr></table></figure>

<h6 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql #下载mysql镜像，默认下载latest</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定版本下载</span> </span><br><span class="line">docker pull mysql:5.7</span><br></pre></td></tr></table></figure>

<h6 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f &lt;id&gt; #通关id删除镜像,可以通过放入多个ID同时删除多个镜像</span><br><span class="line">docker rmi -f $(docker images -aq) #删除所有镜像</span><br></pre></td></tr></table></figure>

<h4 id="3-容器命令"><a href="#3-容器命令" class="headerlink" title="3.容器命令"></a>3.容器命令</h4><h6 id="运行容器"><a href="#运行容器" class="headerlink" title="运行容器"></a>运行容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">docker pill centos #先下载镜像</span><br><span class="line"></span><br><span class="line">docker run [可选参数] 镜像名字</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;   #容器名字，用来区分容器</span><br><span class="line">-d              #后台启动</span><br><span class="line">-it             #使用交互式方式运行，进入容器查看内容</span><br><span class="line">-p(小写)         #指定容器的端口  -p 8080:8080</span><br><span class="line">-e              #环境配置</span><br><span class="line">	 -p  ip:主机端口:容器端口</span><br><span class="line">	 -p  主机端口:容器端口  #常用</span><br><span class="line">	 -p  容器端口</span><br><span class="line">-P(大写)         #随机指定端口</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试</span></span><br><span class="line">docker run -it centos /bin/bash  #/bin/bash是交互运行的控制台  还有/bin/sh</span><br></pre></td></tr></table></figure>

<h6 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a>退出容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit                             #容器停止并退出</span><br><span class="line">Ctrl + P +Q                      #容器不停止退出</span><br></pre></td></tr></table></figure>

<h6 id="查看在运行的容器"><a href="#查看在运行的容器" class="headerlink" title="查看在运行的容器"></a>查看在运行的容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker ps                        #查看正在运行的容器</span><br><span class="line">		-a     #查看所有历史命令</span><br><span class="line">		-n=?   #查看最近创建的容器</span><br><span class="line">		-q     #只显示容器的ID，和镜像一样，-aq  可以连用</span><br></pre></td></tr></table></figure>

<h6 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID                    #删除指定的容器,不能删除正在运行的容器,如果要删除加  -f</span><br><span class="line">docker rm -f $(docker ps -aq)      #删除所有的容器</span><br><span class="line">docker ps -a -q | xargs docker rm  #删除所有的容器</span><br></pre></td></tr></table></figure>

<h6 id="启动和停止容器的操作"><a href="#启动和停止容器的操作" class="headerlink" title="启动和停止容器的操作"></a>启动和停止容器的操作</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器ID        #启动容器</span><br><span class="line">docker restart  容器ID     #重启容器</span><br><span class="line">docker stop   容器ID       #停止当前正在运行的容器</span><br><span class="line">docker  kill  容器ID       #强制停止当前容器</span><br></pre></td></tr></table></figure>

<h2 id="五、常用的其他命令"><a href="#五、常用的其他命令" class="headerlink" title="五、常用的其他命令"></a>五、常用的其他命令</h2><h4 id="1-后台启动容器"><a href="#1-后台启动容器" class="headerlink" title="1.后台启动容器"></a>1.后台启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 镜像名    #docker ps 发现容器停止了   因为后台容器运行必须有一个前台进程</span><br></pre></td></tr></table></figure>

<h4 id="2-查看日志"><a href="#2-查看日志" class="headerlink" title="2.查看日志"></a>2.查看日志</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker logs  -tf  容器ID #容器所有日志</span><br><span class="line">            --tail 10   #显示10条日志</span><br><span class="line">            -t          #加上时间戳</span><br><span class="line">            -f          #持续显示日志</span><br></pre></td></tr></table></figure>

<h4 id="3-查看容器中的进程信息"><a href="#3-查看容器中的进程信息" class="headerlink" title="3.查看容器中的进程信息"></a>3.查看容器中的进程信息</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器ID  #查看容器内部的进程ID</span><br></pre></td></tr></table></figure>

<h4 id="4-查看镜像的元数据"><a href="#4-查看镜像的元数据" class="headerlink" title="4.查看镜像的元数据"></a>4.查看镜像的元数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器ID</span><br></pre></td></tr></table></figure>

<h4 id="5-进入当前正在运行的容器"><a href="#5-进入当前正在运行的容器" class="headerlink" title="5.进入当前正在运行的容器"></a>5.进入当前正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方式一        进入容器后启动新的终端</span></span><br><span class="line">docker exec  -it 容器ID  /bin/bash 或者 /bin/sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方式二        进入正在运行的容器</span></span><br><span class="line">docker attach 容器ID </span><br></pre></td></tr></table></figure>

<h4 id="6-从容器内拷贝文件到主机上"><a href="#6-从容器内拷贝文件到主机上" class="headerlink" title="6.从容器内拷贝文件到主机上"></a>6.从容器内拷贝文件到主机上</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进入容器</span></span><br><span class="line">docker attach 容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拷贝文件</span></span><br><span class="line">docker cp  容器ID: 容器内路径  容器外路径</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拷贝是一个手动过程，为了可以使用 -v 卷的技术实现自动同步</span></span><br></pre></td></tr></table></figure>

<h2 id="六、可视化工具"><a href="#六、可视化工具" class="headerlink" title="六、可视化工具"></a>六、可视化工具</h2><ul>
<li><p>portainer（先用这个）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:9000 \</span><br><span class="line">  --restart=always -v /var/run/docker.sock:/var/run/docker.sock  --privileged=poratainer/portainer</span><br><span class="line"><span class="meta prompt_">  </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">访问测试: locakhost:8088</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">选择本地</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">速度很慢</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Rancher(CI/CD) </p>
</li>
</ul>
<p>持续集成  持续部署用Rancher</p>
<h2 id="七、commit镜像"><a href="#七、commit镜像" class="headerlink" title="七、commit镜像"></a>七、commit镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker commit 提交一个容器成为新的副本</span></span><br><span class="line">docker commit -m&quot;提交的描述信息&quot;  -a=&quot;作者&quot; 容器ID 镜像名:[TAG]</span><br></pre></td></tr></table></figure>


      
    </div>
  </div>
  
</article>



  
    <article id="post-Nginx的基本使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/11/Nginx%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2021-03-11T09:41:40.000Z" itemprop="datePublished">2021-03-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/11/Nginx%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">Nginx的基本使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、Nginx的安装"><a href="#一、Nginx的安装" class="headerlink" title="一、Nginx的安装"></a>一、Nginx的安装</h2><h4 id="Windows下安装"><a href="#Windows下安装" class="headerlink" title="Windows下安装"></a>Windows下安装</h4><h6 id="1-下载Nginx"><a href="#1-下载Nginx" class="headerlink" title="1.下载Nginx"></a>1.下载Nginx</h6><p><a target="_blank" rel="noopener" href="http://nginx.org/en/download.html">http://nginx.org/en/download.html</a> 下载稳定版。</p>
<p>以nginx/Windows-1.18.0为例：<a target="_blank" rel="noopener" href="http://nginx.org/download/nginx-1.18.0.zip，下载后解压。">http://nginx.org/download/nginx-1.18.0.zip，下载后解压。</a></p>
<h6 id="2-安装Nginx"><a href="#2-安装Nginx" class="headerlink" title="2.安装Nginx"></a>2.安装Nginx</h6><p>Windows下直接在cmd窗口启动nginx.exe，好像不支持中文路径。</p>
<p>conf/nginx.conf是配置文件</p>
<h6 id="3-检测是否启动成功"><a href="#3-检测是否启动成功" class="headerlink" title="3.检测是否启动成功"></a>3.检测是否启动成功</h6><p>访问：<a target="_blank" rel="noopener" href="http://localhost/">http://localhost/</a></p>
<h4 id="Linux下的安装"><a href="#Linux下的安装" class="headerlink" title="Linux下的安装"></a>Linux下的安装</h4><h6 id="1-下载Nginx-1"><a href="#1-下载Nginx-1" class="headerlink" title="1.下载Nginx"></a>1.下载Nginx</h6><p>以nginx-1.18.0为例：<a target="_blank" rel="noopener" href="http://nginx.org/download/nginx-1.18.0.tar.gz">http://nginx.org/download/nginx-1.18.0.tar.gz</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf  nginx-1.18.0  <span class="comment">#tar -zxvf用于解压 .tar.gz和.tgz</span></span><br></pre></td></tr></table></figure>

<p>用命令解压</p>
<h6 id="2-安装Nginx-1"><a href="#2-安装Nginx-1" class="headerlink" title="2.安装Nginx"></a>2.安装Nginx</h6><p>进入解压后的Nginx目录后，执行安装命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./configure  <span class="comment">#是用来检测你的安装平台的目标特征的。比如它会检测你是不是有CC或GCC，并不是需要CC或GCC，它是个shell脚本。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#make是用来编译的，它从Makefile中读取指令，然后编译。   make install是用来安装的，它也从Makefile中读取指令，安装到指定的位置。</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whereis nginx <span class="comment">#查询nginx的目录</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/ngxin/ <span class="comment">#一般情况下nginx会在这个目录</span></span><br><span class="line">./sbin/nginx <span class="comment">#直接启动nginx</span></span><br></pre></td></tr></table></figure>



<h6 id="3-检测是否启动成功-1"><a href="#3-检测是否启动成功-1" class="headerlink" title="3.检测是否启动成功"></a>3.检测是否启动成功</h6><p>访问服务器IP地址+设置的端口号</p>
<h2 id="二、Nginx的常用命令"><a href="#二、Nginx的常用命令" class="headerlink" title="二、Nginx的常用命令"></a>二、Nginx的常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#以下命令都在nginx的sbin目录下执行</span></span><br><span class="line">./nginx <span class="comment">#启动</span></span><br><span class="line">./nginx -s stop <span class="comment">#停止</span></span><br><span class="line">./nginx -s quit <span class="comment">#安全退出</span></span><br><span class="line">./nginx -s reload <span class="comment">#重新加载配置文件</span></span><br><span class="line">ps aux|grep nginx <span class="comment">#查看nginx进程</span></span><br></pre></td></tr></table></figure>



<h2 id="三、Nginx的配置文件"><a href="#三、Nginx的配置文件" class="headerlink" title="三、Nginx的配置文件"></a>三、Nginx的配置文件</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user  nobody;  #用来显示是谁运行的Nginx</span></span><br><span class="line"><span class="attribute">worker_processes</span>  <span class="number">1</span>;  <span class="comment">#工作进程数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;   #不同的错误日志级别</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;  #nginx的进程ID</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>;  <span class="comment">#最大连接数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       mime.types;  <span class="comment">#包括</span></span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream;  <span class="comment">#响应类型</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>; </span><br><span class="line">    <span class="comment">#指定是否使用sendfile系统调用来传输文件。</span></span><br><span class="line">    <span class="comment">#sendfile系统调用在两个文件描述符之间直接传递数据(完全在内核中操作)，</span></span><br><span class="line">    <span class="comment">#从而避免了数据在内核缓冲区和用户缓冲区之间的拷贝，操作效率很高，被称之为零拷贝</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>; <span class="comment">#超时</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">#可以有多个sever，用来配置https，也就是443端口</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#负载均衡,有多个代理时使用</span></span><br><span class="line">    <span class="section">upstream</span> kileas&#123;</span><br><span class="line">        <span class="attribute">server</span> <span class="number">127.0.0.1:8080</span> weight=<span class="number">1</span>;   <span class="comment">#weight是权重</span></span><br><span class="line">        <span class="attribute">server</span> <span class="number">127.0.0.1:8081</span> weight=<span class="number">1</span>;  <span class="comment">#注意；号,其中一个无法访问时依然可以正常运行</span></span><br><span class="line">        <span class="comment">#服务器资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>; <span class="comment">#端口号</span></span><br><span class="line">        <span class="attribute">server_name</span>  localhost;  <span class="comment">#ip地址</span></span><br><span class="line">        </span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="comment">#root   html;</span></span><br><span class="line">            <span class="comment">#index  index.html index.htm;  #返回静态html</span></span><br><span class="line">            <span class="attribute">proxy_pass</span> http://kileas;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">#错误页面设置</span></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line">        <span class="attribute">error_page</span>   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /50x.html;</span><br><span class="line">        <span class="section">location</span> = /50x.html &#123;</span><br><span class="line">            <span class="attribute">root</span>   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
  </div>
  
</article>



  
    <article id="post-Linux的打包与解包" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/11/Linux%E7%9A%84%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85/" class="article-date">
  <time class="dt-published" datetime="2021-03-11T09:31:40.000Z" itemprop="datePublished">2021-03-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/11/Linux%E7%9A%84%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85/">Linux的打包与解包</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="tar"><a href="#tar" class="headerlink" title=".tar"></a>.tar</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">打包:tar -xvf 文件名.tar</span><br><span class="line">解包:tar cvf 文件名.tar DirName</span><br><span class="line"><span class="comment">#注：tar是打包，不是压缩！</span></span><br></pre></td></tr></table></figure>

<h4 id="gz"><a href="#gz" class="headerlink" title=".gz"></a>.gz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">解压1：gunzip 文件名.gz</span><br><span class="line">解压2：gzip -d 文件名.gz</span><br><span class="line">压缩：gzip 文件名</span><br></pre></td></tr></table></figure>

<h4 id="tar-gz-和-tgz"><a href="#tar-gz-和-tgz" class="headerlink" title=".tar.gz 和 .tgz"></a>.tar.gz 和 .tgz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：tar zxvf 文件名.tar.gz</span><br><span class="line">压缩：tar zcvf 文件名.tar.gz DirName</span><br></pre></td></tr></table></figure>

<h4 id="bz2"><a href="#bz2" class="headerlink" title=".bz2"></a>.bz2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">解压1：bzip2 -d 文件名.bz2</span><br><span class="line">解压2：bunzip2 文件名.bz2</span><br><span class="line">压缩： bzip2 -z 文件名</span><br></pre></td></tr></table></figure>

<h4 id="tar-bz2"><a href="#tar-bz2" class="headerlink" title=".tar.bz2"></a>.tar.bz2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：tar jxvf 文件名.tar.bz2</span><br><span class="line">压缩：tar jcvf 文件名.tar.bz2 路径名</span><br></pre></td></tr></table></figure>

<h4 id="bz"><a href="#bz" class="headerlink" title=".bz"></a>.bz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压1：bzip2 -d 文件名.bz</span><br><span class="line">解压2：bunzip2 文件名.bz</span><br></pre></td></tr></table></figure>

<h4 id="tar-bz"><a href="#tar-bz" class="headerlink" title=".tar.bz"></a>.tar.bz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解压：tar jxvf 文件名.tar.bz</span><br></pre></td></tr></table></figure>

<h4 id="Z"><a href="#Z" class="headerlink" title=".Z"></a>.Z</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：uncompress 文件名.Z</span><br><span class="line">压缩：compress 文件名</span><br></pre></td></tr></table></figure>

<h4 id="tar-z"><a href="#tar-z" class="headerlink" title=".tar.z"></a>.tar.z</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：tar Zxvf 文件名.tar.Z</span><br><span class="line">压缩：tar Zcvf 文件名.tar.Z 路径名</span><br></pre></td></tr></table></figure>

<h4 id="zip"><a href="#zip" class="headerlink" title=".zip"></a>.zip</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：unzip 文件名.zip</span><br><span class="line">压缩：zip 文件名.zip 路径名</span><br></pre></td></tr></table></figure>

<h4 id="rar"><a href="#rar" class="headerlink" title=".rar"></a>.rar</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：rar x 文件名.rar</span><br><span class="line">压缩：rar a 文件名.rar 路径名</span><br></pre></td></tr></table></figure>

<h4 id="lha"><a href="#lha" class="headerlink" title=".lha"></a>.lha</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：lha -e 文件名.lha</span><br><span class="line">压缩：lha -a 文件名.lha 路径名</span><br></pre></td></tr></table></figure>

<h4 id="rpm"><a href="#rpm" class="headerlink" title=".rpm"></a>.rpm</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解包：rpm2cpio 文件名.rpm | cpio -div</span><br></pre></td></tr></table></figure>

<h4 id="deb"><a href="#deb" class="headerlink" title=".deb"></a>.deb</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解包：ar p 文件名.deb data.tar.gz | tar zxf -</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-用Golang批量修改文件名" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/18/%E7%94%A8Golang%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%90%8D/" class="article-date">
  <time class="dt-published" datetime="2021-02-18T09:57:11.000Z" itemprop="datePublished">2021-02-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/18/%E7%94%A8Golang%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%90%8D/">用Golang批量修改文件名</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="用Golang批量修改文件名"><a href="#用Golang批量修改文件名" class="headerlink" title="用Golang批量修改文件名"></a>用Golang批量修改文件名</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;path&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需要修改的目录</span></span><br><span class="line">	way := <span class="string">&quot;C:\\Users\\zhou\\Desktop\\音频\\&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//用数字取名</span></span><br><span class="line">	num := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取文件夹内的信息</span></span><br><span class="line">	files, err := ioutil.ReadDir(way)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//打印错误信息</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环修改文件名</span></span><br><span class="line">	<span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//获取后缀</span></span><br><span class="line">		suf := path.Ext(file.Name())</span><br><span class="line"></span><br><span class="line">        <span class="comment">//拼接新名字</span></span><br><span class="line">		name := way + strconv.Itoa(num) + suf</span><br><span class="line"></span><br><span class="line">		fmt.Println(name)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//修改文件名 </span></span><br><span class="line">		err = os.Rename(way+file.Name(), name)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Fatal(err)</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">		num += <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
  </div>
  
</article>



  
    <article id="post-Golang的Print与进度条" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/03/Golang%E7%9A%84Print%E4%B8%8E%E8%BF%9B%E5%BA%A6%E6%9D%A1/" class="article-date">
  <time class="dt-published" datetime="2021-02-03T07:52:50.000Z" itemprop="datePublished">2021-02-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/03/Golang%E7%9A%84Print%E4%B8%8E%E8%BF%9B%E5%BA%A6%E6%9D%A1/">Golang的Print与进度条</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="进度条"><a href="#进度条" class="headerlink" title="进度条"></a>进度条</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> Bar struct &#123;</span><br><span class="line">	percent int64  //百分比</span><br><span class="line">	cur     int64  //当前进度位置</span><br><span class="line">	total   int64  //总进度</span><br><span class="line">	rate    string //进度条</span><br><span class="line">	graph   string //显示符号</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bar *Bar) NewOption(start, total int64) &#123;</span><br><span class="line">	bar.cur = start</span><br><span class="line">	bar.total = total</span><br><span class="line">	<span class="keyword">if</span> bar.graph == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		bar.graph = <span class="string">&quot;█&quot;</span></span><br><span class="line">	&#125;//如果没有自定义，就是用█符号</span><br><span class="line">	bar.percent = bar.getPercent()</span><br><span class="line">	fmt.Println(bar.percent)</span><br><span class="line">	<span class="keyword">for</span> i := 0; i &lt; int(bar.percent); i += 2 &#123;</span><br><span class="line">		bar.rate += bar.graph //初始化进度条位置,i+=2是初始化时的进度条位置</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bar *Bar) getPercent() int64 &#123;</span><br><span class="line">	<span class="built_in">return</span> int64(float32(bar.cur) / float32(bar.total) * 100)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bar *Bar) NewOptionWithGraph(start, total int64, graph string) &#123;</span><br><span class="line">	bar.graph = graph</span><br><span class="line">	bar.NewOption(start, total)</span><br><span class="line">&#125; //这里可以自己输入一个进度条符号</span><br><span class="line"></span><br><span class="line">func (bar *Bar) <span class="function"><span class="title">Finish</span></span>()&#123;</span><br><span class="line">	fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (bar *Bar) Play(cur int64) &#123;</span><br><span class="line">	bar.cur = cur</span><br><span class="line">	last := bar.percent //先拿到之前的进度</span><br><span class="line">	bar.percent = bar.getPercent()//计算现在的进度</span><br><span class="line">	<span class="keyword">if</span> bar.percent != last &amp;&amp; bar.percent%2 == 0 &#123; //进度条有变动且增加2时进度条前进一格</span><br><span class="line">		bar.rate += bar.graph</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\r[%-50s]%3d%%  %8d/%d&quot;</span>, bar.rate, bar.percent, bar.cur, bar.total)//制表符的使用</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func execution(start int64,end int64) &#123;</span><br><span class="line">	var bar Bar</span><br><span class="line">	bar.NewOptionWithGraph(start, end,<span class="string">&quot;&gt;&quot;</span>) //参数分别是进度起始点,总数和进度条符号</span><br><span class="line">	<span class="keyword">for</span> i:= start; i&lt;=end; i++&#123;</span><br><span class="line">		time.Sleep(100*time.Millisecond)  //等待时间</span><br><span class="line">		bar.Play(int64(i))</span><br><span class="line">	&#125;</span><br><span class="line">	bar.Finish()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">	execution(50,100)//起始位置和总数</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Golang的Print"><a href="#Golang的Print" class="headerlink" title="Golang的Print"></a>Golang的Print</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Print系列函数会将内容输出到系统的标准输出，</span><br><span class="line"></span><br><span class="line">区别在于Print函数直接输出内容，</span><br><span class="line"></span><br><span class="line">Printf函数支持格式化输出字符串，</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;\r[%-10d]&quot;</span>,1) -是指向右对齐，默认向左</span><br><span class="line"></span><br><span class="line">Println函数会在输出内容的结尾添加一个换行符。</span><br><span class="line"></span><br><span class="line">Sprint系列函数会把传入的数据生成并返回一个字符串。 <span class="comment">#返回值需要有变量接收</span></span><br><span class="line"></span><br><span class="line">Errorf函数根据format参数生成格式化字符串并返回一个包含该字符串的错误。</span><br><span class="line"></span><br><span class="line">Fprint系列函数会将内容输出到一个io.Writer接口类型的变量w中，我们通常用这个函数往文件中写入内容。</span><br><span class="line"></span><br><span class="line">*<span class="built_in">printf</span>系列函数都支持format格式化参数，在这里我们按照占位符将被替换的变量类型划分，方便查询和记忆。</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-Golang获取B站弹幕" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/10/07/Golang%E8%8E%B7%E5%8F%96B%E7%AB%99%E5%BC%B9%E5%B9%95/" class="article-date">
  <time class="dt-published" datetime="2020-10-07T10:09:57.000Z" itemprop="datePublished">2020-10-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/10/07/Golang%E8%8E%B7%E5%8F%96B%E7%AB%99%E5%BC%B9%E5%B9%95/">Golang获取B站弹幕</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="使用Websocket获取B站弹幕"><a href="#使用Websocket获取B站弹幕" class="headerlink" title="使用Websocket获取B站弹幕"></a>使用Websocket获取B站弹幕</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;bytes&quot;</span></span><br><span class="line">	<span class="string">&quot;compress/zlib&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gocolly/colly&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/widuu/gojson&quot;</span></span><br><span class="line">	<span class="string">&quot;golang.org/x/net/websocket&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;math&quot;</span></span><br><span class="line">	<span class="string">&quot;regexp&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> Danmu struct &#123;</span><br><span class="line">	Uid       int    `json:<span class="string">&quot;uid&quot;</span>`</span><br><span class="line">	Roomid    int    `json:<span class="string">&quot;roomid&quot;</span>`</span><br><span class="line">	Protover  int    `json:<span class="string">&quot;protover&quot;</span>`</span><br><span class="line">	Platform  string `json:<span class="string">&quot;platform&quot;</span>`</span><br><span class="line">	Clientver string `json:<span class="string">&quot;clientver&quot;</span>`</span><br><span class="line">	Type      int    `json:<span class="string">&quot;type&quot;</span>`</span><br><span class="line">	Key       string `json:<span class="string">&quot;key&quot;</span>`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">	var <span class="built_in">id</span> string</span><br><span class="line">	fmt.Print(<span class="string">&quot;请输入房间ID：&quot;</span>)</span><br><span class="line">	_, _ = fmt.Scanln(&amp;<span class="built_in">id</span>)</span><br><span class="line">	neirong, _ := getStockList(<span class="string">&quot;https://api.live.bilibili.com/room/v1/Room/room_init?id=&quot;</span> + <span class="built_in">id</span>)</span><br><span class="line">	roomid := gojson.Json(neirong).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;room_id&quot;</span>).Tostring() //获取房间真实ID</span><br><span class="line">	rommid_int, _ := strconv.Atoi(roomid)</span><br><span class="line"></span><br><span class="line">	host, _ := getStockList(<span class="string">&quot;https://api.live.bilibili.com/room/v1/Danmu/getConf?room_id=&quot;</span> + roomid + <span class="string">&quot;&amp;platform=pc&amp;player=web&quot;</span>)</span><br><span class="line">	token := gojson.Json(host).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;token&quot;</span>).Tostring()</span><br><span class="line"></span><br><span class="line">	danmu := Danmu&#123;</span><br><span class="line">		Uid:       0,</span><br><span class="line">		Roomid:    rommid_int,</span><br><span class="line">		Protover:  1,</span><br><span class="line">		Platform:  <span class="string">&quot;web&quot;</span>,</span><br><span class="line">		Clientver: <span class="string">&quot;2.0.7&quot;</span>,</span><br><span class="line">		Type:      2,</span><br><span class="line">		Key:       token,</span><br><span class="line">	&#125; //握手用json数据包</span><br><span class="line"></span><br><span class="line">	v, _ := json.Marshal(danmu) //结构体转json</span><br><span class="line"></span><br><span class="line">	code := encode(string(v), 7) //握手协议</span><br><span class="line"></span><br><span class="line">	code.Write([]byte(string(v))) //写入body</span><br><span class="line"></span><br><span class="line">	ws, err := websocket.Dial(<span class="string">&quot;wss://tx-gz-live-comet-02.chat.bilibili.com/sub&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;https://live.bilibili.com&quot;</span>) //wss连接</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;链接错误&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	_, _ = ws.Write(code.Bytes()) //发送握手包</span><br><span class="line"></span><br><span class="line">	shuchu := make([]byte, 26) //接收返回</span><br><span class="line"></span><br><span class="line">	_, err = ws.Read(shuchu)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;握手失败&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> string(shuchu[16:26]) == <span class="string">&quot;&#123;\&quot;code\&quot;:0&#125;&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;握手成功,正在心跳....&quot;</span>)</span><br><span class="line">		go xintiao(ws)</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			dan := make([]byte, 10000)</span><br><span class="line">			_, _ = ws.Read(dan)</span><br><span class="line"></span><br><span class="line">			xieyi := readint16(toint16(dan[0:16]), 6, 2) //数据协议</span><br><span class="line"></span><br><span class="line">			switch xieyi &#123;</span><br><span class="line">			<span class="keyword">case</span> 1:</span><br><span class="line">				popularity := readint20(toint20(dan[0:20]), 16, 4) //人气</span><br><span class="line">				fmt.Println(<span class="string">&quot;当前人气为:&quot;</span>, popularity)</span><br><span class="line">			<span class="keyword">case</span> 2:</span><br><span class="line">				bodylen := readint16(toint16(dan[0:16]), 0, 4) //数据包的长度</span><br><span class="line"></span><br><span class="line">				danjs := DoZlibUnCompress(dan[16:bodylen])</span><br><span class="line"></span><br><span class="line">				r, _ := regexp.Compile(<span class="string">&quot;&#123;.*?[&#125;|\\]]&#125;&quot;</span>) //正则匹配</span><br><span class="line">				danmumsg := r.FindAllStringSubmatch(string(danjs),-1)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span> _, v := range danmumsg &#123;</span><br><span class="line">					<span class="keyword">for</span> _ ,k := range v&#123;</span><br><span class="line">						cmd := gojson.Json(k).Get(<span class="string">&quot;cmd&quot;</span>).Tostring()//信息类型</span><br><span class="line">						switch cmd &#123;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&quot;DANMU_MSG&quot;</span>:</span><br><span class="line">							nei := gojson.Json(k).Get(<span class="string">&quot;info&quot;</span>).Getindex(2).Tostring()//弹幕内容</span><br><span class="line">							name := gojson.Json(k).Get(<span class="string">&quot;info&quot;</span>).Getindex(3).Getindex(2).Tostring()//发送者名字</span><br><span class="line">							fmt.Println(name+<span class="string">&quot;：&quot;</span>+nei)</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">case</span> 3:</span><br><span class="line">				popularity := readint20(toint20(dan[0:20]), 16, 4) //人气</span><br><span class="line">				fmt.Println(<span class="string">&quot;当前人气为:&quot;</span>, popularity)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func encode(str string, op int) bytes.Buffer &#123;</span><br><span class="line">	packelen := 16 + len(str)</span><br><span class="line">	header := [16]int&#123;0, 0, 0, 0, 0, 16, 0, 1, 0, 0, 0, op, 0, 0, 0, 1&#125;</span><br><span class="line">	writeInt(&amp;header, 0, 4, packelen)</span><br><span class="line"></span><br><span class="line">	var code bytes.Buffer</span><br><span class="line">	code.Write(tobyte(header)) //写入header</span><br><span class="line"></span><br><span class="line">	<span class="built_in">return</span> code //buffer协议</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func writeInt(buffer *[16]int, start int, len int, value int) &#123;</span><br><span class="line">	<span class="keyword">for</span> i := 0; i &lt; len; i++ &#123;</span><br><span class="line">		p := math.Pow(256, float64(len-i-1))</span><br><span class="line">		buffer[start+i] = value / int(p)</span><br><span class="line">	&#125;</span><br><span class="line">&#125; //头部协议</span><br><span class="line"></span><br><span class="line">func tobyte(header [16]int) []byte &#123;</span><br><span class="line">	body := make([]byte, 16)</span><br><span class="line">	<span class="keyword">for</span> i := 0; i &lt; 16; i++ &#123;</span><br><span class="line">		body[i] = byte(header[i])</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> body</span><br><span class="line">&#125; //int转byte</span><br><span class="line"></span><br><span class="line">func readint20(buffer [20]int, start int, len int) int &#123;</span><br><span class="line">	result := 0</span><br><span class="line">	<span class="keyword">for</span> i := len - 1; i &gt;= 0; i-- &#123;</span><br><span class="line">		result += int(math.Pow(256, float64(len-i-1))) * buffer[start+i]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> result</span><br><span class="line">&#125; //计算人气</span><br><span class="line"></span><br><span class="line">func readint16(buffer [16]int, start int, len int) int &#123;</span><br><span class="line">	result := 0</span><br><span class="line">	<span class="keyword">for</span> i := len - 1; i &gt;= 0; i-- &#123;</span><br><span class="line">		result += int(math.Pow(256, float64(len-i-1))) * buffer[start+i]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> result</span><br><span class="line">&#125; //计算头部</span><br><span class="line"></span><br><span class="line">func toint16(t []byte) [16]int &#123;</span><br><span class="line">	header := [16]int&#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> k, v := range t &#123;</span><br><span class="line">		header[k] = int(v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> header</span><br><span class="line">&#125; //转换格式</span><br><span class="line"></span><br><span class="line">func toint20(t []byte) [20]int &#123;</span><br><span class="line">	header := [20]int&#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> k, v := range t &#123;</span><br><span class="line">		header[k] = int(v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> header</span><br><span class="line">&#125; //转换格式</span><br><span class="line"></span><br><span class="line">//解压缩</span><br><span class="line">func DoZlibUnCompress(compressSrc []byte) []byte &#123;</span><br><span class="line">	b := bytes.NewReader(compressSrc)</span><br><span class="line">	var out bytes.Buffer</span><br><span class="line">	r, _ := zlib.NewReader(b)</span><br><span class="line">	io.Copy(&amp;out, r)</span><br><span class="line">	<span class="built_in">return</span> out.Bytes()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//心跳</span><br><span class="line">func xintiao(ws *websocket.Conn) &#123;</span><br><span class="line">	t := time.NewTimer(time.Second * 25)</span><br><span class="line">	defer t.Stop()</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		&lt;-t.C</span><br><span class="line">		xin := encode(<span class="string">&quot;&quot;</span>, 2)</span><br><span class="line">		_, err := ws.Write(xin.Bytes())</span><br><span class="line">		<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;心跳失败&quot;</span>) //第一次发送心跳包</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;心跳成功&quot;</span>)</span><br><span class="line"></span><br><span class="line">		// 需要重置Reset 使 t 重新开始计时</span><br><span class="line">		t.Reset(time.Second * 25)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getStockList(url string) (stockList string, err error) &#123;</span><br><span class="line"></span><br><span class="line">	//创建对象</span><br><span class="line">	c := colly.NewCollector()</span><br><span class="line"></span><br><span class="line">	//请求头</span><br><span class="line">	c.UserAgent = <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) &quot;</span> +</span><br><span class="line">		<span class="string">&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36&quot;</span></span><br><span class="line">	//写入请求头</span><br><span class="line">	c.OnRequest(func(r *colly.Request) &#123;</span><br><span class="line">		r.Headers.Set(<span class="string">&quot;cookie&quot;</span>, <span class="string">&quot;cookie&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	//返回的Response body</span><br><span class="line">	c.OnResponse(func(resp *colly.Response) &#123;</span><br><span class="line">		stockList = string(resp.Body)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	//返回的错误信息</span><br><span class="line">	c.OnError(func(resp *colly.Response, errHttp error) &#123;</span><br><span class="line">		err = errHttp</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err = c.Visit(url)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-git的安装和clone加速" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/28/git%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8Cclone%E5%8A%A0%E9%80%9F/" class="article-date">
  <time class="dt-published" datetime="2020-09-28T02:39:11.000Z" itemprop="datePublished">2020-09-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/28/git%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8Cclone%E5%8A%A0%E9%80%9F/">git的安装设置和clone加速</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="git安装"><a href="#git安装" class="headerlink" title="git安装"></a>git安装</h2><h4 id="Liunx下安装"><a href="#Liunx下安装" class="headerlink" title="Liunx下安装"></a>Liunx下安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git-all</span><br></pre></td></tr></table></figure>
<h4 id="Windows下安装"><a href="#Windows下安装" class="headerlink" title="Windows下安装"></a>Windows下安装</h4><p><a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/git-for-windows/" title="淘宝镜像">淘宝镜像源</a></p>
<h2 id="git加速"><a href="#git加速" class="headerlink" title="git加速"></a>git加速</h2><p>原克隆地址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Bililive/www.danmuji.org.git</span><br></pre></td></tr></table></figure>
<p>修改为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com.cnpmjs.org/Bililive/www.danmuji.org.git</span><br></pre></td></tr></table></figure>

<p>直接使用<a target="_blank" rel="noopener" href="http://gitd.cc/" title="这是Git的免费代理网站">代理下载</a></p>
<h2 id="git设置"><a href="#git设置" class="headerlink" title="git设置"></a>git设置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、设置用户名</span><br><span class="line"></span><br><span class="line">git config --global user.name <span class="string">&#x27;用户名&#x27;</span></span><br><span class="line"></span><br><span class="line">2、设置用户邮箱</span><br><span class="line"></span><br><span class="line">git config --global user.email <span class="string">&#x27;用户邮箱&#x27;</span></span><br><span class="line"></span><br><span class="line">3、查看设置</span><br><span class="line"></span><br><span class="line">git config --list</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-Golang实时获取弹幕" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/06/Golang%E5%AE%9E%E6%97%B6%E8%8E%B7%E5%8F%96%E5%BC%B9%E5%B9%95/" class="article-date">
  <time class="dt-published" datetime="2020-09-06T11:59:22.000Z" itemprop="datePublished">2020-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/09/06/Golang%E5%AE%9E%E6%97%B6%E8%8E%B7%E5%8F%96%E5%BC%B9%E5%B9%95/">Golang实时获取弹幕</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="直接上源码"><a href="#直接上源码" class="headerlink" title="直接上源码"></a>直接上源码</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gocolly/colly&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/widuu/gojson&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	url := <span class="string">&quot;https://api.live.bilibili.com/xlive/web-room/v1/dM/gethistory&quot;</span></span><br><span class="line"></span><br><span class="line">	InitConfig()</span><br><span class="line"></span><br><span class="line">	roomid := viper.GetString(<span class="string">&quot;roomid&quot;</span>)</span><br><span class="line"></span><br><span class="line">	data := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line">		<span class="string">&quot;roomid&quot;</span>: roomid, <span class="comment">//房间ID</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	timeend := <span class="number">0</span> <span class="comment">//时间戳</span></span><br><span class="line">	uidend := <span class="string">&quot;&quot;</span>  <span class="comment">//发送者uid，用来确定同时发送的弹幕</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		body, _ := getStockList(url, data)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="number">11</span>; i++ &#123;</span><br><span class="line"></span><br><span class="line">			rnd := gojson.Json(body).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;room&quot;</span>).Getkey(<span class="string">&quot;check_info&quot;</span>, i).Get(<span class="string">&quot;ts&quot;</span>).Tostring()</span><br><span class="line"></span><br><span class="line">			text := gojson.Json(body).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;room&quot;</span>).Getkey(<span class="string">&quot;text&quot;</span>, i).Tostring()</span><br><span class="line"></span><br><span class="line">			timen, _ := strconv.Atoi(rnd)</span><br><span class="line"></span><br><span class="line">			ct := gojson.Json(body).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;room&quot;</span>).Getkey(<span class="string">&quot;check_info&quot;</span>, i).Get(<span class="string">&quot;ct&quot;</span>).Tostring()</span><br><span class="line"></span><br><span class="line">			nickname := gojson.Json(body).Get(<span class="string">&quot;data&quot;</span>).Get(<span class="string">&quot;room&quot;</span>).Getkey(<span class="string">&quot;nickname&quot;</span>, i).Tostring()</span><br><span class="line">			<span class="keyword">if</span> timen &gt;= timeend &#123;</span><br><span class="line">				<span class="keyword">if</span> ct == uidend &amp;&amp; timen == timeend &#123;&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					timeend, _ = strconv.Atoi(rnd)</span><br><span class="line">					uidend = ct</span><br><span class="line">					fmt.Println(nickname + <span class="string">&quot;：&quot;</span> + text)</span><br><span class="line">					fmt.Println(<span class="string">&quot;--------&quot;</span>)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		time.Sleep(time.Duration(<span class="number">2</span>) * time.Second)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InitConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">	wordDir, _ := os.Getwd()     <span class="comment">//获取文件夹路径</span></span><br><span class="line">	viper.SetConfigName(<span class="string">&quot;app&quot;</span>)   <span class="comment">//配置文件名称</span></span><br><span class="line">	viper.SetConfigType(<span class="string">&quot;yml&quot;</span>)   <span class="comment">//配置文件类型</span></span><br><span class="line">	viper.AddConfigPath(wordDir) <span class="comment">//配置文件路径指定</span></span><br><span class="line">	err := viper.ReadInConfig()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err) <span class="comment">//弹出错误</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getStockList</span><span class="params">(url <span class="type">string</span>, data <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span></span> (stockList <span class="type">string</span>, err <span class="type">error</span>) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建对象</span></span><br><span class="line">	c := colly.NewCollector()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回的Response body</span></span><br><span class="line">	c.OnResponse(<span class="function"><span class="keyword">func</span><span class="params">(resp *colly.Response)</span></span> &#123;</span><br><span class="line">		stockList = <span class="type">string</span>(resp.Body)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回的错误信息</span></span><br><span class="line">	c.OnError(<span class="function"><span class="keyword">func</span><span class="params">(resp *colly.Response, errHttp <span class="type">error</span>)</span></span> &#123;</span><br><span class="line">		err = errHttp</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送Post请求</span></span><br><span class="line">	err = c.Post(url, data)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="关键字注释"><a href="#关键字注释" class="headerlink" title="关键字注释"></a>关键字注释</h2><table>
<thead>
<tr>
<th>关键字</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>roomid</td>
<td>B站直播间ID</td>
</tr>
</tbody></table>
<blockquote>
<h4 id="由于发送弹幕原理差不多-就不重新实现一遍了，Python处有写"><a href="#由于发送弹幕原理差不多-就不重新实现一遍了，Python处有写" class="headerlink" title="由于发送弹幕原理差不多,就不重新实现一遍了，Python处有写"></a>由于发送弹幕原理差不多,就不重新实现一遍了，Python处有写</h4></blockquote>
<blockquote>
<h4 id="全都是B站直播间"><a href="#全都是B站直播间" class="headerlink" title="全都是B站直播间"></a>全都是B站直播间</h4></blockquote>

      
    </div>
  </div>
  
</article>



  
    <article id="post-Golang实现网页内容批量查找" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/08/15/Golang%E5%AE%9E%E7%8E%B0%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E6%89%B9%E9%87%8F%E6%9F%A5%E6%89%BE/" class="article-date">
  <time class="dt-published" datetime="2020-08-15T09:28:30.000Z" itemprop="datePublished">2020-08-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/08/15/Golang%E5%AE%9E%E7%8E%B0%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E6%89%B9%E9%87%8F%E6%9F%A5%E6%89%BE/">Golang实现网页内容批量查找</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="直接上源码"><a href="#直接上源码" class="headerlink" title="直接上源码"></a>直接上源码</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/antchfx/htmlquery&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gocolly/colly&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/spf13/viper&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	InitConfig()</span><br><span class="line"></span><br><span class="line">	cookies := viper.GetString(<span class="string">&quot;cookies&quot;</span>)</span><br><span class="line">	url := viper.GetString(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">	name := viper.GetString(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">	xpath := viper.GetString(<span class="string">&quot;xpath&quot;</span>)</span><br><span class="line">	page := viper.GetInt(<span class="string">&quot;page&quot;</span>)</span><br><span class="line">	href := viper.GetString(<span class="string">&quot;href&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= page; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(url <span class="type">string</span>, i <span class="type">int</span>, href <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">			url = fmt.Sprintf(url, i)</span><br><span class="line">			stock, _ := getStockList(url, cookies)</span><br><span class="line">			ParseTagList(stock, i, name, xpath, href)</span><br><span class="line">		&#125;(url, i, href)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;查找结束输入任意内容并回车退出程序....&quot;</span>)</span><br><span class="line">	<span class="keyword">var</span> t <span class="type">string</span></span><br><span class="line">	_, err := fmt.Scanln(&amp;t)</span><br><span class="line">	fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getStockList</span><span class="params">(url <span class="type">string</span>, cookies <span class="type">string</span>)</span></span> (stockList <span class="type">string</span>, err <span class="type">error</span>) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建对象</span></span><br><span class="line">	c := colly.NewCollector()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//请求头</span></span><br><span class="line">	c.UserAgent = <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) &quot;</span> +</span><br><span class="line">		<span class="string">&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//写入请求头</span></span><br><span class="line">	c.OnRequest(<span class="function"><span class="keyword">func</span><span class="params">(r *colly.Request)</span></span> &#123;</span><br><span class="line">		r.Headers.Set(<span class="string">&quot;cookie&quot;</span>, cookies)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回的Response body</span></span><br><span class="line">	c.OnResponse(<span class="function"><span class="keyword">func</span><span class="params">(resp *colly.Response)</span></span> &#123;</span><br><span class="line">		stockList = <span class="type">string</span>(resp.Body)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回的错误信息</span></span><br><span class="line">	c.OnError(<span class="function"><span class="keyword">func</span><span class="params">(resp *colly.Response, errHttp <span class="type">error</span>)</span></span> &#123;</span><br><span class="line">		err = errHttp</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err = c.Visit(url)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ParseTagList</span><span class="params">(contents <span class="type">string</span>, i <span class="type">int</span>, name <span class="type">string</span>, xpath <span class="type">string</span>, href <span class="type">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	doc, _ := htmlquery.Parse(strings.NewReader(contents))</span><br><span class="line"></span><br><span class="line">	tr := htmlquery.Find(doc, xpath)</span><br><span class="line">	<span class="keyword">for</span> _, row := <span class="keyword">range</span> tr &#123;</span><br><span class="line">		item := htmlquery.OutputHTML(row, <span class="literal">false</span>)</span><br><span class="line">		href_now := htmlquery.InnerText(htmlquery.Find(row, <span class="string">&quot;@href&quot;</span>)[<span class="number">0</span>])</span><br><span class="line">		<span class="keyword">if</span> strings.Index(item, name) != <span class="number">-1</span> &#123;</span><br><span class="line">			fmt.Println(item + <span class="string">&quot;:&quot;</span> + href + href_now)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InitConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">	wordDir, _ := os.Getwd()     <span class="comment">//获取文件夹路径</span></span><br><span class="line">	viper.SetConfigName(<span class="string">&quot;app&quot;</span>)   <span class="comment">//配置文件名称</span></span><br><span class="line">	viper.SetConfigType(<span class="string">&quot;yaml&quot;</span>)  <span class="comment">//配置文件类型</span></span><br><span class="line">	viper.AddConfigPath(wordDir) <span class="comment">//配置文件路径指定</span></span><br><span class="line">	err := viper.ReadInConfig()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;配置文件不存在,请在同目录下创建app.yaml文件并进行配置&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><p>在同目录下创建一个app.yaml的文件</p>
<h2 id="关键字注释"><a href="#关键字注释" class="headerlink" title="关键字注释"></a>关键字注释</h2><table>
<thead>
<tr>
<th>关键字</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>cookies</td>
<td>用来储存登录信息</td>
</tr>
<tr>
<td>url</td>
<td>批量查询的网页</td>
</tr>
<tr>
<td>name</td>
<td>你要查询的关键字</td>
</tr>
<tr>
<td>xpath</td>
<td>xpath路径</td>
</tr>
<tr>
<td>page</td>
<td>需要查询多少页</td>
</tr>
<tr>
<td>href</td>
<td>用于拼接超链接的链接</td>
</tr>
</tbody></table>

      
    </div>
  </div>
  
</article>



  
    <article id="post-Golang分布式爬虫" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/08/15/Golang%E5%88%86%E5%B8%83%E5%BC%8F%E7%88%AC%E8%99%AB/" class="article-date">
  <time class="dt-published" datetime="2020-08-15T07:51:06.000Z" itemprop="datePublished">2020-08-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/08/15/Golang%E5%88%86%E5%B8%83%E5%BC%8F%E7%88%AC%E8%99%AB/">Golang分布式爬虫</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="colly库的安装"><a href="#colly库的安装" class="headerlink" title="colly库的安装"></a>colly库的安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get <span class="string">&quot;github.com/gocolly/colly&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="colly库基本使用"><a href="#colly库基本使用" class="headerlink" title="colly库基本使用"></a>colly库基本使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">func getStockList(url string) (stockList string, err error) &#123;</span><br><span class="line"></span><br><span class="line">	//创建对象</span><br><span class="line">	c := colly.NewCollector()</span><br><span class="line"></span><br><span class="line">		//请求头</span><br><span class="line">        c.UserAgent = <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) &quot;</span> +</span><br><span class="line">    	    <span class="string">&quot;AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36&quot;</span></span><br><span class="line"></span><br><span class="line">	// auth认证</span><br><span class="line">	err := c.Post(<span class="string">&quot;url/login&quot;</span>, map[string]string&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;admin&quot;</span>&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	//返回的Response body</span><br><span class="line">	c.OnResponse(func(resp *colly.Response) &#123;</span><br><span class="line">		stockList = string(resp.Body)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	//返回的错误信息</span><br><span class="line">	c.OnError(func(resp *colly.Response, errHttp error) &#123;</span><br><span class="line">		err = errHttp</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	err = c.Visit(url)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="htmlquery的简单使用"><a href="#htmlquery的简单使用" class="headerlink" title="htmlquery的简单使用"></a>htmlquery的简单使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">func ParseTagList(contents string,i int ,name string ,xpath string)  &#123;</span><br><span class="line"></span><br><span class="line">	doc, _ := htmlquery.Parse(strings.NewReader(contents))</span><br><span class="line"></span><br><span class="line">	<span class="built_in">tr</span> := htmlquery.Find(doc, xpath)</span><br><span class="line">	<span class="keyword">for</span> _, row := range <span class="built_in">tr</span> &#123;</span><br><span class="line">	    //输出text</span><br><span class="line">		item := htmlquery.OutputHTML(row,<span class="literal">false</span>)</span><br><span class="line">		fmt.Pirntln(item)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/" rel="tag">Github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spleeter/" rel="tag">Spleeter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tampermonkey/" rel="tag">Tampermonkey</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/" rel="tag">ios</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%95%9C%E5%83%8F/" rel="tag">镜像</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 12.5px;">Docker</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Golang/" style="font-size: 20px;">Golang</a> <a href="/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/tags/Linux/" style="font-size: 12.5px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/Spleeter/" style="font-size: 10px;">Spleeter</a> <a href="/tags/Tampermonkey/" style="font-size: 15px;">Tampermonkey</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/nodejs/" style="font-size: 12.5px;">nodejs</a> <a href="/tags/%E9%95%9C%E5%83%8F/" style="font-size: 10px;">镜像</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">九月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/09/28/%E9%95%9C%E5%83%8F%E7%9B%B8%E5%85%B3/">镜像相关</a>
          </li>
        
          <li>
            <a href="/2024/09/28/JS%E9%80%86%E5%90%91/">JS逆向</a>
          </li>
        
          <li>
            <a href="/2024/02/06/U%E7%9B%98%E5%9B%BE%E6%A0%87%E3%80%81CMD%E5%91%BD%E4%BB%A4%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E3%80%81%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80/">U盘图标、CMD命令、结构体、字符串、文件后缀</a>
          </li>
        
          <li>
            <a href="/2023/12/11/Golang%E5%8D%8F%E7%A8%8B%E9%98%BB%E5%A1%9E%E7%9A%84%E9%97%AE%E9%A2%98/">Golang协程阻塞的问题</a>
          </li>
        
          <li>
            <a href="/2023/09/23/%E4%BD%BF%E7%94%A8TinyPNG-API%E8%A3%81%E5%89%AA%E5%9B%BE%E7%89%87%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">使用TinyPNG-API裁剪图片遇到的问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 鱼糕先生<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">文章</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>