<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Kilesa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Kilesa">
<meta property="og:url" content="https://gitee.com/kilesa/kilesa/index.html">
<meta property="og:site_name" content="Kilesa">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="鱼糕先生">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Kilesa</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">文章</a>
        
      </nav>
      <nav id="sub-nav">
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-pyinstxtractor" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/21/pyinstxtractor/" class="article-date">
  <time class="dt-published" datetime="2022-10-21T05:33:56.000Z" itemprop="datePublished">2022-10-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/21/pyinstxtractor/">pyinstxtractor</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="这是Pyinstxtractor的备份"><a href="#这是Pyinstxtractor的备份" class="headerlink" title="这是Pyinstxtractor的备份"></a>这是Pyinstxtractor的备份</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">PyInstaller Extractor v2.0 (Supports pyinstaller 5.4.1, 5.4, 5.3, 5.2, 5.1, 5.0.1, 5.0, 4.10, 4.9, 4.8, 4.7, 4.6, 4.5.1, 4.5, 4.4, 4.3, 4.2, 4.1, 4.0, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1, 3.0, 2.1, 2.0)</span></span><br><span class="line"><span class="string">Author : Extreme Coders</span></span><br><span class="line"><span class="string">E-mail : extremecoders(at)hotmail(dot)com</span></span><br><span class="line"><span class="string">Web    : https://0xec.blogspot.com</span></span><br><span class="line"><span class="string">Date   : 26-March-2020</span></span><br><span class="line"><span class="string">Url    : https://github.com/extremecoders-re/pyinstxtractor</span></span><br><span class="line"><span class="string">For any suggestions, leave a comment on</span></span><br><span class="line"><span class="string">https://forum.tuts4you.com/topic/34455-pyinstaller-extractor/</span></span><br><span class="line"><span class="string">This script extracts a pyinstaller generated executable file.</span></span><br><span class="line"><span class="string">Pyinstaller installation is not needed. The script has it all.</span></span><br><span class="line"><span class="string">For best results, it is recommended to run this script in the</span></span><br><span class="line"><span class="string">same version of python as was used to create the executable.</span></span><br><span class="line"><span class="string">This is just to prevent unmarshalling errors(if any) while</span></span><br><span class="line"><span class="string">extracting the PYZ archive.</span></span><br><span class="line"><span class="string">Usage : Just copy this script to the directory where your exe resides</span></span><br><span class="line"><span class="string">        and run the script with the exe file name as a parameter</span></span><br><span class="line"><span class="string">C:\path\to\exe\&gt;python pyinstxtractor.py &lt;filename&gt;</span></span><br><span class="line"><span class="string">$ /path/to/exe/python pyinstxtractor.py &lt;filename&gt;</span></span><br><span class="line"><span class="string">Licensed under GNU General Public License (GPL) v3.</span></span><br><span class="line"><span class="string">You are free to modify this source.</span></span><br><span class="line"><span class="string">CHANGELOG</span></span><br><span class="line"><span class="string">================================================</span></span><br><span class="line"><span class="string">Version 1.1 (Jan 28, 2014)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- First Release</span></span><br><span class="line"><span class="string">- Supports only pyinstaller 2.0</span></span><br><span class="line"><span class="string">Version 1.2 (Sept 12, 2015)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Added support for pyinstaller 2.1 and 3.0 dev</span></span><br><span class="line"><span class="string">- Cleaned up code</span></span><br><span class="line"><span class="string">- Script is now more verbose</span></span><br><span class="line"><span class="string">- Executable extracted within a dedicated sub-directory</span></span><br><span class="line"><span class="string">(Support for pyinstaller 3.0 dev is experimental)</span></span><br><span class="line"><span class="string">Version 1.3 (Dec 12, 2015)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Added support for pyinstaller 3.0 final</span></span><br><span class="line"><span class="string">- Script is compatible with both python 2.x &amp; 3.x (Thanks to Moritz Kroll @ Avira Operations GmbH &amp; Co. KG)</span></span><br><span class="line"><span class="string">Version 1.4 (Jan 19, 2016)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Fixed a bug when writing pyc files &gt;= version 3.3 (Thanks to Daniello Alto: https://github.com/Djamana)</span></span><br><span class="line"><span class="string">Version 1.5 (March 1, 2016)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Added support for pyinstaller 3.1 (Thanks to Berwyn Hoyt for reporting)</span></span><br><span class="line"><span class="string">Version 1.6 (Sept 5, 2016)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Added support for pyinstaller 3.2</span></span><br><span class="line"><span class="string">- Extractor will use a random name while extracting unnamed files.</span></span><br><span class="line"><span class="string">- For encrypted pyz archives it will dump the contents as is. Previously, the tool would fail.</span></span><br><span class="line"><span class="string">Version 1.7 (March 13, 2017)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Made the script compatible with python 2.6 (Thanks to Ross for reporting)</span></span><br><span class="line"><span class="string">Version 1.8 (April 28, 2017)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Support for sub-directories in .pyz files (Thanks to Moritz Kroll @ Avira Operations GmbH &amp; Co. KG)</span></span><br><span class="line"><span class="string">Version 1.9 (November 29, 2017)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Added support for pyinstaller 3.3</span></span><br><span class="line"><span class="string">- Display the scripts which are run at entry (Thanks to Michael Gillespie @ malwarehunterteam for the feature request)</span></span><br><span class="line"><span class="string">Version 2.0 (March 26, 2020)</span></span><br><span class="line"><span class="string">-------------------------------------------------</span></span><br><span class="line"><span class="string">- Project migrated to github</span></span><br><span class="line"><span class="string">- Supports pyinstaller 3.6</span></span><br><span class="line"><span class="string">- Added support for Python 3.7, 3.8</span></span><br><span class="line"><span class="string">- The header of all extracted pyc&#x27;s are now automatically fixed</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4 <span class="keyword">as</span> uniquename</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CTOCEntry</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, position, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name</span>):</span><br><span class="line">        self.position = position</span><br><span class="line">        self.cmprsdDataSize = cmprsdDataSize</span><br><span class="line">        self.uncmprsdDataSize = uncmprsdDataSize</span><br><span class="line">        self.cmprsFlag = cmprsFlag</span><br><span class="line">        self.typeCmprsData = typeCmprsData</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PyInstArchive</span>:</span><br><span class="line">    PYINST20_COOKIE_SIZE = <span class="number">24</span>           <span class="comment"># For pyinstaller 2.0</span></span><br><span class="line">    PYINST21_COOKIE_SIZE = <span class="number">24</span> + <span class="number">64</span>      <span class="comment"># For pyinstaller 2.1+</span></span><br><span class="line">    MAGIC = <span class="string">b&#x27;MEI\014\013\012\013\016&#x27;</span>  <span class="comment"># Magic number which identifies pyinstaller</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, path</span>):</span><br><span class="line">        self.filePath = path</span><br><span class="line">        self.pycMagic = <span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span></span><br><span class="line">        self.barePycList = [] <span class="comment"># List of pyc&#x27;s whose headers have to be fixed</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.fPtr = <span class="built_in">open</span>(self.filePath, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">            self.fileSize = os.stat(self.filePath).st_size</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Error: Could not open &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(self.filePath))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.fPtr.close()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkFile</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Processing &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(self.filePath))</span><br><span class="line"></span><br><span class="line">        searchChunkSize = <span class="number">8192</span></span><br><span class="line">        endPos = self.fileSize</span><br><span class="line">        self.cookiePos = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> endPos &lt; <span class="built_in">len</span>(self.MAGIC):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Error : File is too short or truncated&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            startPos = endPos - searchChunkSize <span class="keyword">if</span> endPos &gt;= searchChunkSize <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            chunkSize = endPos - startPos</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> chunkSize &lt; <span class="built_in">len</span>(self.MAGIC):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            self.fPtr.seek(startPos, os.SEEK_SET)</span><br><span class="line">            data = self.fPtr.read(chunkSize)</span><br><span class="line"></span><br><span class="line">            offs = data.rfind(self.MAGIC)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> offs != -<span class="number">1</span>:</span><br><span class="line">                self.cookiePos = startPos + offs</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            endPos = startPos + <span class="built_in">len</span>(self.MAGIC) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> startPos == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.cookiePos == -<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Error : Missing cookie, unsupported pyinstaller version or not a pyinstaller archive&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        self.fPtr.seek(self.cookiePos + self.PYINST20_COOKIE_SIZE, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;python&#x27;</span> <span class="keyword">in</span> self.fPtr.read(<span class="number">64</span>).lower():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Pyinstaller version: 2.1+&#x27;</span>)</span><br><span class="line">            self.pyinstVer = <span class="number">21</span>     <span class="comment"># pyinstaller 2.1+</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.pyinstVer = <span class="number">20</span>     <span class="comment"># pyinstaller 2.0</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Pyinstaller version: 2.0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getCArchiveInfo</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.pyinstVer == <span class="number">20</span>:</span><br><span class="line">                self.fPtr.seek(self.cookiePos, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Read CArchive cookie</span></span><br><span class="line">                (magic, lengthofPackage, toc, tocLen, pyver) = \</span><br><span class="line">                struct.unpack(<span class="string">&#x27;!8siiii&#x27;</span>, self.fPtr.read(self.PYINST20_COOKIE_SIZE))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.pyinstVer == <span class="number">21</span>:</span><br><span class="line">                self.fPtr.seek(self.cookiePos, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Read CArchive cookie</span></span><br><span class="line">                (magic, lengthofPackage, toc, tocLen, pyver, pylibname) = \</span><br><span class="line">                struct.unpack(<span class="string">&#x27;!8siiii64s&#x27;</span>, self.fPtr.read(self.PYINST21_COOKIE_SIZE))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[!] Error : The file is not a pyinstaller archive&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        self.pymaj, self.pymin = (pyver//<span class="number">100</span>, pyver%<span class="number">100</span>) <span class="keyword">if</span> pyver &gt;= <span class="number">100</span> <span class="keyword">else</span> (pyver//<span class="number">10</span>, pyver%<span class="number">10</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Python version: &#123;0&#125;.&#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(self.pymaj, self.pymin))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Additional data after the cookie</span></span><br><span class="line">        tailBytes = self.fileSize - self.cookiePos - (self.PYINST20_COOKIE_SIZE <span class="keyword">if</span> self.pyinstVer == <span class="number">20</span> <span class="keyword">else</span> self.PYINST21_COOKIE_SIZE)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Overlay is the data appended at the end of the PE</span></span><br><span class="line">        self.overlaySize = lengthofPackage + tailBytes</span><br><span class="line">        self.overlayPos = self.fileSize - self.overlaySize</span><br><span class="line">        self.tableOfContentsPos = self.overlayPos + toc</span><br><span class="line">        self.tableOfContentsSize = tocLen</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Length of package: &#123;0&#125; bytes&#x27;</span>.<span class="built_in">format</span>(lengthofPackage))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parseTOC</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Go to the table of contents</span></span><br><span class="line">        self.fPtr.seek(self.tableOfContentsPos, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">        self.tocList = []</span><br><span class="line">        parsedLen = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Parse table of contents</span></span><br><span class="line">        <span class="keyword">while</span> parsedLen &lt; self.tableOfContentsSize:</span><br><span class="line">            (entrySize, ) = struct.unpack(<span class="string">&#x27;!i&#x27;</span>, self.fPtr.read(<span class="number">4</span>))</span><br><span class="line">            nameLen = struct.calcsize(<span class="string">&#x27;!iiiiBc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            (entryPos, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name) = \</span><br><span class="line">            struct.unpack( \</span><br><span class="line">                <span class="string">&#x27;!iiiBc&#123;0&#125;s&#x27;</span>.<span class="built_in">format</span>(entrySize - nameLen), \</span><br><span class="line">                self.fPtr.read(entrySize - <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">            name = name.decode(<span class="string">&#x27;utf-8&#x27;</span>).rstrip(<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(name) == <span class="number">0</span>:</span><br><span class="line">                name = <span class="built_in">str</span>(uniquename())</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Warning: Found an unamed file in CArchive. Using random name &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(name))</span><br><span class="line"></span><br><span class="line">            self.tocList.append( \</span><br><span class="line">                                CTOCEntry(                      \</span><br><span class="line">                                    self.overlayPos + entryPos, \</span><br><span class="line">                                    cmprsdDataSize,             \</span><br><span class="line">                                    uncmprsdDataSize,           \</span><br><span class="line">                                    cmprsFlag,                  \</span><br><span class="line">                                    typeCmprsData,              \</span><br><span class="line">                                    name                        \</span><br><span class="line">                                ))</span><br><span class="line"></span><br><span class="line">            parsedLen += entrySize</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Found &#123;0&#125; files in CArchive&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(self.tocList)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_writeRawData</span>(<span class="params">self, filepath, data</span>):</span><br><span class="line">        nm = filepath.replace(<span class="string">&#x27;\\&#x27;</span>, os.path.sep).replace(<span class="string">&#x27;/&#x27;</span>, os.path.sep).replace(<span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;__&#x27;</span>)</span><br><span class="line">        nmDir = os.path.dirname(nm)</span><br><span class="line">        <span class="keyword">if</span> nmDir != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> <span class="keyword">not</span> os.path.exists(nmDir): <span class="comment"># Check if path exists, create if not</span></span><br><span class="line">            os.makedirs(nmDir)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(nm, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extractFiles</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Beginning extraction...please standby&#x27;</span>)</span><br><span class="line">        extractionDir = os.path.join(os.getcwd(), os.path.basename(self.filePath) + <span class="string">&#x27;_extracted&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(extractionDir):</span><br><span class="line">            os.mkdir(extractionDir)</span><br><span class="line"></span><br><span class="line">        os.chdir(extractionDir)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> entry <span class="keyword">in</span> self.tocList:</span><br><span class="line">            self.fPtr.seek(entry.position, os.SEEK_SET)</span><br><span class="line">            data = self.fPtr.read(entry.cmprsdDataSize)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> entry.cmprsFlag == <span class="number">1</span>:</span><br><span class="line">                data = zlib.decompress(data)</span><br><span class="line">                <span class="comment"># Malware may tamper with the uncompressed size</span></span><br><span class="line">                <span class="comment"># Comment out the assertion in such a case</span></span><br><span class="line">                <span class="keyword">assert</span> <span class="built_in">len</span>(data) == entry.uncmprsdDataSize <span class="comment"># Sanity Check</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> entry.typeCmprsData == <span class="string">b&#x27;d&#x27;</span> <span class="keyword">or</span> entry.typeCmprsData == <span class="string">b&#x27;o&#x27;</span>:</span><br><span class="line">                <span class="comment"># d -&gt; ARCHIVE_ITEM_DEPENDENCY</span></span><br><span class="line">                <span class="comment"># o -&gt; ARCHIVE_ITEM_RUNTIME_OPTION</span></span><br><span class="line">                <span class="comment"># These are runtime options, not files</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            basePath = os.path.dirname(entry.name)</span><br><span class="line">            <span class="keyword">if</span> basePath != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                <span class="comment"># Check if path exists, create if not</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(basePath):</span><br><span class="line">                    os.makedirs(basePath)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> entry.typeCmprsData == <span class="string">b&#x27;s&#x27;</span>:</span><br><span class="line">                <span class="comment"># s -&gt; ARCHIVE_ITEM_PYSOURCE</span></span><br><span class="line">                <span class="comment"># Entry point are expected to be python scripts</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[+] Possible entry point: &#123;0&#125;.pyc&#x27;</span>.<span class="built_in">format</span>(entry.name))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> self.pycMagic == <span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>:</span><br><span class="line">                    <span class="comment"># if we don&#x27;t have the pyc header yet, fix them in a later pass</span></span><br><span class="line">                    self.barePycList.append(entry.name + <span class="string">&#x27;.pyc&#x27;</span>)</span><br><span class="line">                self._writePyc(entry.name + <span class="string">&#x27;.pyc&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> entry.typeCmprsData == <span class="string">b&#x27;M&#x27;</span> <span class="keyword">or</span> entry.typeCmprsData == <span class="string">b&#x27;m&#x27;</span>:</span><br><span class="line">                <span class="comment"># M -&gt; ARCHIVE_ITEM_PYPACKAGE</span></span><br><span class="line">                <span class="comment"># m -&gt; ARCHIVE_ITEM_PYMODULE</span></span><br><span class="line">                <span class="comment"># packages and modules are pyc files with their header intact</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># From PyInstaller 5.3 and above pyc headers are no longer stored</span></span><br><span class="line">                <span class="comment"># https://github.com/pyinstaller/pyinstaller/commit/a97fdf</span></span><br><span class="line">                <span class="keyword">if</span> data[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">b&#x27;\r\n&#x27;</span>:</span><br><span class="line">                    <span class="comment"># &lt; pyinstaller 5.3</span></span><br><span class="line">                    <span class="keyword">if</span> self.pycMagic == <span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>: </span><br><span class="line">                        self.pycMagic = data[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">                    self._writeRawData(entry.name + <span class="string">&#x27;.pyc&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># &gt;= pyinstaller 5.3</span></span><br><span class="line">                    <span class="keyword">if</span> self.pycMagic == <span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>:</span><br><span class="line">                        <span class="comment"># if we don&#x27;t have the pyc header yet, fix them in a later pass</span></span><br><span class="line">                        self.barePycList.append(entry.name + <span class="string">&#x27;.pyc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                    self._writePyc(entry.name + <span class="string">&#x27;.pyc&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._writeRawData(entry.name, data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> entry.typeCmprsData == <span class="string">b&#x27;z&#x27;</span> <span class="keyword">or</span> entry.typeCmprsData == <span class="string">b&#x27;Z&#x27;</span>:</span><br><span class="line">                    self._extractPyz(entry.name)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Fix bare pyc&#x27;s if any</span></span><br><span class="line">        self._fixBarePycs()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_fixBarePycs</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> pycFile <span class="keyword">in</span> self.barePycList:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(pycFile, <span class="string">&#x27;r+b&#x27;</span>) <span class="keyword">as</span> pycFile:</span><br><span class="line">                <span class="comment"># Overwrite the first four bytes</span></span><br><span class="line">                pycFile.write(self.pycMagic)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_writePyc</span>(<span class="params">self, filename, data</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> pycFile:</span><br><span class="line">            pycFile.write(self.pycMagic)            <span class="comment"># pyc magic</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> self.pymaj &gt;= <span class="number">3</span> <span class="keyword">and</span> self.pymin &gt;= <span class="number">7</span>:                <span class="comment"># PEP 552 -- Deterministic pycs</span></span><br><span class="line">                pycFile.write(<span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>)        <span class="comment"># Bitfield</span></span><br><span class="line">                pycFile.write(<span class="string">b&#x27;\0&#x27;</span> * <span class="number">8</span>)        <span class="comment"># (Timestamp + size) || hash </span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pycFile.write(<span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>)      <span class="comment"># Timestamp</span></span><br><span class="line">                <span class="keyword">if</span> self.pymaj &gt;= <span class="number">3</span> <span class="keyword">and</span> self.pymin &gt;= <span class="number">3</span>:</span><br><span class="line">                    pycFile.write(<span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>)  <span class="comment"># Size parameter added in Python 3.3</span></span><br><span class="line"></span><br><span class="line">            pycFile.write(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_extractPyz</span>(<span class="params">self, name</span>):</span><br><span class="line">        dirName =  name + <span class="string">&#x27;_extracted&#x27;</span></span><br><span class="line">        <span class="comment"># Create a directory for the contents of the pyz</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dirName):</span><br><span class="line">            os.mkdir(dirName)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(name, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            pyzMagic = f.read(<span class="number">4</span>)</span><br><span class="line">            <span class="keyword">assert</span> pyzMagic == <span class="string">b&#x27;PYZ\0&#x27;</span> <span class="comment"># Sanity Check</span></span><br><span class="line"></span><br><span class="line">            pyzPycMagic = f.read(<span class="number">4</span>) <span class="comment"># Python magic value</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> self.pycMagic == <span class="string">b&#x27;\0&#x27;</span> * <span class="number">4</span>:</span><br><span class="line">                self.pycMagic = pyzPycMagic</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.pycMagic != pyzPycMagic:</span><br><span class="line">                self.pycMagic = pyzPycMagic</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Warning: pyc magic of files inside PYZ archive are different from those in CArchive&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Skip PYZ extraction if not running under the same python version</span></span><br><span class="line">            <span class="keyword">if</span> self.pymaj != sys.version_info.major <span class="keyword">or</span> self.pymin != sys.version_info.minor:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Warning: This script is running in a different Python version than the one used to build the executable.&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Please run this script in Python &#123;0&#125;.&#123;1&#125; to prevent extraction errors during unmarshalling&#x27;</span>.<span class="built_in">format</span>(self.pymaj, self.pymin))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Skipping pyz extraction&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            (tocPosition, ) = struct.unpack(<span class="string">&#x27;!i&#x27;</span>, f.read(<span class="number">4</span>))</span><br><span class="line">            f.seek(tocPosition, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                toc = marshal.load(f)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[!] Unmarshalling FAILED. Cannot extract &#123;0&#125;. Extracting remaining files.&#x27;</span>.<span class="built_in">format</span>(name))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Found &#123;0&#125; files in PYZ archive&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(toc)))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># From pyinstaller 3.1+ toc is a list of tuples</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(toc) == <span class="built_in">list</span>:</span><br><span class="line">                toc = <span class="built_in">dict</span>(toc)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> key <span class="keyword">in</span> toc.keys():</span><br><span class="line">                (ispkg, pos, length) = toc[key]</span><br><span class="line">                f.seek(pos, os.SEEK_SET)</span><br><span class="line">                fileName = key</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># for Python &gt; 3.3 some keys are bytes object some are str object</span></span><br><span class="line">                    fileName = fileName.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># Prevent writing outside dirName</span></span><br><span class="line">                fileName = fileName.replace(<span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;__&#x27;</span>).replace(<span class="string">&#x27;.&#x27;</span>, os.path.sep)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ispkg == <span class="number">1</span>:</span><br><span class="line">                    filePath = os.path.join(dirName, fileName, <span class="string">&#x27;__init__.pyc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    filePath = os.path.join(dirName, fileName + <span class="string">&#x27;.pyc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                fileDir = os.path.dirname(filePath)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fileDir):</span><br><span class="line">                    os.makedirs(fileDir)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    data = f.read(length)</span><br><span class="line">                    data = zlib.decompress(data)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[!] Error: Failed to decompress &#123;0&#125;, probably encrypted. Extracting as is.&#x27;</span>.<span class="built_in">format</span>(filePath))</span><br><span class="line">                    <span class="built_in">open</span>(filePath + <span class="string">&#x27;.encrypted&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(data)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self._writePyc(filePath, data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Usage: pyinstxtractor.py &lt;filename&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        arch = PyInstArchive(sys.argv[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> arch.<span class="built_in">open</span>():</span><br><span class="line">            <span class="keyword">if</span> arch.checkFile():</span><br><span class="line">                <span class="keyword">if</span> arch.getCArchiveInfo():</span><br><span class="line">                    arch.parseTOC()</span><br><span class="line">                    arch.extractFiles()</span><br><span class="line">                    arch.close()</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;[+] Successfully extracted pyinstaller archive: &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(sys.argv[<span class="number">1</span>]))</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;You can now use a python decompiler on the pyc files within the extracted directory&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            arch.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-网页上添加一个按钮" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/16/%E7%BD%91%E9%A1%B5%E4%B8%8A%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%8C%89%E9%92%AE/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T16:34:06.000Z" itemprop="datePublished">2022-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/16/%E7%BD%91%E9%A1%B5%E4%B8%8A%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%8C%89%E9%92%AE/">网页上添加一个按钮</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> button = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;button&#x27;</span>)      <span class="comment">//创建按钮</span></span><br><span class="line">button.<span class="property">innerText</span> = <span class="string">&quot;采集&quot;</span>                          <span class="comment">//设置按钮内文字</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;fixed&#x27;</span>                   <span class="comment">//设置位置,fixed会固定在屏幕上,跟着滚动</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;2px 6px&#x27;</span>                  <span class="comment">//设置内边距</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">bottom</span> = <span class="string">&#x27;0&#x27;</span>                         <span class="comment">//设置元素的底部部位置</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">right</span> = <span class="string">&#x27;0&#x27;</span>                          <span class="comment">//设置元素的左部位置</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="string">&#x27;99999&#x27;</span>                     <span class="comment">//元素堆叠位置,99999 总在最上</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">borderRadius</span> = <span class="string">&#x27;4px&#x27;</span>                 <span class="comment">//设置为圆角边框</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;#606266&quot;</span>                    <span class="comment">//规定文本的颜色</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&quot;1px solid #dcdfe6&quot;</span>         <span class="comment">//边框样式,solid是实线边框</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;#fff&quot;</span>             <span class="comment">//设置按钮的背景色</span></span><br><span class="line">button.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0.8&quot;</span>                      <span class="comment">//将按钮设置为半透明</span></span><br><span class="line">button.<span class="property">onclick</span> = exec                             <span class="comment">//设置点击事件,执行exec函数</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(button)                 <span class="comment">//向body添加按钮</span></span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-python自动执行程序" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/16/python%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F/" class="article-date">
  <time class="dt-published" datetime="2022-08-16T02:35:10.000Z" itemprop="datePublished">2022-08-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/08/16/python%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F/">python自动执行程序</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="一、源代码"><a href="#一、源代码" class="headerlink" title="一、源代码"></a>一、源代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line">import pyautogui, os, time, psutil</span><br><span class="line"></span><br><span class="line">def new(path):</span><br><span class="line">    pyautogui.click(pyautogui.locateOnScreen(path))</span><br><span class="line">    print(&#x27;正在更新...&#x27;)</span><br><span class="line">    if dengdai(os.path.dirname(__file__) + &#x27;./ruby/更新.png&#x27;) == 0:</span><br><span class="line">        return 0</span><br><span class="line">    pl = psutil.pids()</span><br><span class="line">    for pid in pl:</span><br><span class="line">        if psutil.Process(pid).name() == &#x27;Ruby.exe&#x27;:</span><br><span class="line">            print(psutil.Process(pid).name())</span><br><span class="line">            psutil.Process(pid).kill()</span><br><span class="line"></span><br><span class="line">    print(&#x27;正在修改文件名...&#x27;)</span><br><span class="line">    time.sleep(3)</span><br><span class="line">    path = &#x27;C:\\Users\\zhou\\Documents\\ruby&#x27;</span><br><span class="line">    ruby = os.listdir(path)</span><br><span class="line">    x = 0</span><br><span class="line">    for r in ruby:</span><br><span class="line">        print(r)</span><br><span class="line">        if &#x27;ruby&#x27; in r.lower():</span><br><span class="line">            x = x + 1</span><br><span class="line"></span><br><span class="line">    if x == 2:</span><br><span class="line">        os.remove(path + &#x27;\\&#x27; + &#x27;Ruby.exe&#x27;)</span><br><span class="line">        ruby = os.listdir(path)</span><br><span class="line">        for r in ruby:</span><br><span class="line">            if &#x27;ruby&#x27; in r.lower():</span><br><span class="line">                os.rename(path + &#x27;\\&#x27; + r, path + &#x27;\\&#x27; + &#x27;Ruby.exe&#x27;)</span><br><span class="line">                print(&#x27;重命名成功!!!&#x27;)</span><br><span class="line">                time.sleep(10)</span><br><span class="line">                print(&#x27;更新完成!&#x27;)</span><br><span class="line">                return 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def dianji(path):</span><br><span class="line">    T1 = int(time.time())</span><br><span class="line">    while 1:</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        pl = psutil.pids()</span><br><span class="line">        pidto = 0</span><br><span class="line">        for pid in pl:</span><br><span class="line">            if psutil.Process(pid).name() == &#x27;Ruby.exe&#x27;:</span><br><span class="line">                pidto = pid</span><br><span class="line"></span><br><span class="line">        if pidto != 0:</span><br><span class="line">            if psutil.Process(pidto).is_running() != True:</span><br><span class="line">                psutil.Process(pidto).kill()</span><br><span class="line">                return 0</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;进程不存在!!!&#x27;)</span><br><span class="line">            return 0</span><br><span class="line">        location = pyautogui.locateOnScreen(path)</span><br><span class="line">        if location:</span><br><span class="line">            return 1</span><br><span class="line">        T2 = int(time.time())</span><br><span class="line">        if T2 - T1 &gt; 10:</span><br><span class="line">            print(&#x27;无更新!&#x27;)</span><br><span class="line">            return 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def dengdai(path):</span><br><span class="line">    T1 = int(time.time())</span><br><span class="line">    while 1:</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        pl = psutil.pids()</span><br><span class="line">        pidto = 0</span><br><span class="line">        for pid in pl:</span><br><span class="line">            if psutil.Process(pid).name() == &#x27;Ruby.exe&#x27;:</span><br><span class="line">                pidto = pid</span><br><span class="line"></span><br><span class="line">        if pidto != 0:</span><br><span class="line">            if psutil.Process(pidto).is_running() != True:</span><br><span class="line">                psutil.Process(pidto).kill()</span><br><span class="line">                return 0</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;进程不存在!!!&#x27;)</span><br><span class="line">            return 0</span><br><span class="line">        location = pyautogui.locateOnScreen(path)</span><br><span class="line">        if location:</span><br><span class="line">            break</span><br><span class="line">        else:</span><br><span class="line">            T2 = int(time.time())</span><br><span class="line">            if T2 - T1 &gt; 30:</span><br><span class="line">                print(&#x27;任务超时!&#x27;)</span><br><span class="line">                return 0</span><br><span class="line"></span><br><span class="line">    return 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def renwu(path, path2):</span><br><span class="line">    T1 = int(time.time())</span><br><span class="line">    ti = 0</span><br><span class="line">    while 1:</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        pl = psutil.pids()</span><br><span class="line">        pidto = 0</span><br><span class="line">        for pid in pl:</span><br><span class="line">            if psutil.Process(pid).name() == &#x27;Ruby.exe&#x27;:</span><br><span class="line">                pidto = pid</span><br><span class="line"></span><br><span class="line">        if pidto != 0:</span><br><span class="line">            if psutil.Process(pidto).is_running() != True:</span><br><span class="line">                psutil.Process(pidto).kill()</span><br><span class="line">                return 0</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;进程不存在!!!&#x27;)</span><br><span class="line">            return 0</span><br><span class="line">        location = pyautogui.locateOnScreen(path)</span><br><span class="line">        print(location)</span><br><span class="line">        if location:</span><br><span class="line">            return 1</span><br><span class="line">        T2 = int(time.time())</span><br><span class="line">        while True:</span><br><span class="line">            ting = pyautogui.locateOnScreen(path2)</span><br><span class="line">            if ting != None:</span><br><span class="line">                ti = 0</span><br><span class="line">                break</span><br><span class="line">            else:</span><br><span class="line">                ti += 1</span><br><span class="line">                print(&#x27;任务异常第&#123;0&#125;次...&#x27;.format(ti))</span><br><span class="line">                time.sleep(10)</span><br><span class="line">                if ti &gt;= 3:</span><br><span class="line">                    print(&#x27;任务异常停止!&#x27;)</span><br><span class="line">                    return 0</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">        if T2 - T1 &gt; 900:</span><br><span class="line">            print(&#x27;任务超时!&#x27;)</span><br><span class="line">            return 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def qidong():</span><br><span class="line">    path = &#x27;C:/Users/zhou/Documents/ruby/Ruby.exe&#x27;</span><br><span class="line">    os.system(path)</span><br><span class="line">    pyautogui.moveTo(10, 10)</span><br><span class="line">    time.sleep(3)</span><br><span class="line">    if dianji(os.path.dirname(__file__) + &#x27;./ruby/更新.png&#x27;):</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        if new(os.path.dirname(__file__) + &#x27;./ruby/更新.png&#x27;) == 0:</span><br><span class="line">            print(&#x27;更新异常,正在重试...&#x27;)</span><br><span class="line">            return 0</span><br><span class="line">    if dengdai(os.path.dirname(__file__) + &#x27;./ruby/登录.png&#x27;) == 0:</span><br><span class="line">        print(&#x27;登录检测失败,正在重试...&#x27;)</span><br><span class="line">        return 0</span><br><span class="line">    print(&#x27;检测到登录按钮！&#x27;)</span><br><span class="line">    pyautogui.click((pyautogui.locateOnScreen(os.path.dirname(__file__) + &#x27;./ruby/登录.png&#x27;)), button=&#x27;right&#x27;)</span><br><span class="line">    print(&#x27;右击登录按钮成功!&#x27;)</span><br><span class="line">    pyautogui.moveTo(10, 10)</span><br><span class="line">    if dengdai(os.path.dirname(__file__) + &#x27;./ruby/确认.png&#x27;) == 0:</span><br><span class="line">        print(&#x27;确认登录失败,正在重试...&#x27;)</span><br><span class="line">        return 0</span><br><span class="line">    print(&#x27;确认登录成功!&#x27;)</span><br><span class="line">    pyautogui.moveTo(10, 10)</span><br><span class="line">    if dengdai(os.path.dirname(__file__) + &#x27;./ruby/开始.png&#x27;) == 0:</span><br><span class="line">        print(&#x27;任务启动失败,正在重试...&#x27;)</span><br><span class="line">        return 0</span><br><span class="line">    print(&#x27;任务启动成功!&#x27;)</span><br><span class="line">    pyautogui.moveTo(10, 10)</span><br><span class="line">    if renwu(os.path.dirname(__file__) + &#x27;./ruby/结束.png&#x27;, os.path.dirname(__file__) + &#x27;./ruby/开始.png&#x27;) == 0:</span><br><span class="line">        print(&#x27;任务结束失败,正在重试...&#x27;)</span><br><span class="line">        return 0</span><br><span class="line">    print(&#x27;任务结束成功!&#x27;)</span><br><span class="line">    return 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    while True:</span><br><span class="line">        a = qidong()</span><br><span class="line">        if a:</span><br><span class="line">            while True:</span><br><span class="line">                print(&#x27;正在关机...&#x27;)</span><br><span class="line">                os.system(&#x27;shutdown /s /t 0&#x27;)</span><br><span class="line">                time.sleep(5)</span><br><span class="line">        else:</span><br><span class="line">            while True:</span><br><span class="line">                pl = psutil.pids()</span><br><span class="line">                try:</span><br><span class="line">                    for pid in pl:</span><br><span class="line">                        if psutil.Process(pid).name() == &#x27;ruby闪退重启保护.exe&#x27;:</span><br><span class="line">                            ppid = psutil.Process(pid).parent().pid</span><br><span class="line">                            print(psutil.Process(pid).name())</span><br><span class="line">                            print(psutil.Process(pid).parent().name())</span><br><span class="line">                            psutil.Process(pid).kill()</span><br><span class="line">                            time.sleep(1)</span><br><span class="line">                            psutil.pid_exists(ppid)</span><br><span class="line">                            psutil.Process(ppid).kill()</span><br><span class="line"></span><br><span class="line">                    o = 0</span><br><span class="line">                    for i in pl:</span><br><span class="line">                        if &#x27;ruby&#x27; in psutil.Process(i).name().lower():</span><br><span class="line">                            o += 1</span><br><span class="line"></span><br><span class="line">                    print(o)</span><br><span class="line">                    if o != 0:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        break</span><br><span class="line">                except:</span><br><span class="line">                    pass</span><br><span class="line"></span><br><span class="line">            continue</span><br></pre></td></tr></table></figure>
<h3 id="二、设置程序开机自启动"><a href="#二、设置程序开机自启动" class="headerlink" title="二、设置程序开机自启动"></a>二、设置程序开机自启动</h3><h5 id="我的电脑-管理-任务计划启动-新建"><a href="#我的电脑-管理-任务计划启动-新建" class="headerlink" title="我的电脑-管理-任务计划启动-新建"></a><code>我的电脑-管理-任务计划启动-新建</code></h5><h3 id="三、设置向日葵自动开机"><a href="#三、设置向日葵自动开机" class="headerlink" title="三、设置向日葵自动开机"></a>三、设置向日葵自动开机</h3>
      
    </div>
  </div>
  
</article>



  
    <article id="post-python打包与解包exe" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/15/python%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85exe/" class="article-date">
  <time class="dt-published" datetime="2022-08-15T00:09:20.000Z" itemprop="datePublished">2022-08-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/08/15/python%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85exe/">python打包与解包exe</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="使用Pyinstaller打包"><a href="#使用Pyinstaller打包" class="headerlink" title="使用Pyinstaller打包"></a>使用Pyinstaller打包</h2><h4 id="安装pyinstaller库"><a href="#安装pyinstaller库" class="headerlink" title="安装pyinstaller库"></a>安装pyinstaller库</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyinstaller</span><br></pre></td></tr></table></figure>
<h4 id="打包单个文件"><a href="#打包单个文件" class="headerlink" title="打包单个文件"></a>打包单个文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller -F test.py</span><br></pre></td></tr></table></figure>
<h4 id="打包多个或者资源文件"><a href="#打包多个或者资源文件" class="headerlink" title="打包多个或者资源文件"></a>打包多个或者资源文件</h4><h6 id="一、先生成-spec文件"><a href="#一、先生成-spec文件" class="headerlink" title="一、先生成.spec文件"></a>一、先生成.spec文件</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller -F test.py</span><br></pre></td></tr></table></figure>
<h6 id="二、修改-spec配置文件"><a href="#二、修改-spec配置文件" class="headerlink" title="二、修改.spec配置文件"></a>二、修改.spec配置文件</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- mode: python3 ; coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">block_cipher = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = Analysis(</span><br><span class="line">    [<span class="string">&#x27;test.py&#x27;</span>],</span><br><span class="line">    pathex=[],</span><br><span class="line">    binaries=[],</span><br><span class="line">    datas=[(<span class="string">&#x27;资源文件&#x27;</span>,<span class="string">&#x27;资源路径&#x27;</span>),(<span class="string">&#x27;./目录/图片.png&#x27;</span>,<span class="string">&#x27;目录&#x27;</span>)],</span><br><span class="line">    hiddenimports=[],</span><br><span class="line">    hookspath=[],</span><br><span class="line">    hooksconfig=&#123;&#125;,</span><br><span class="line">    runtime_hooks=[],</span><br><span class="line">    excludes=[],</span><br><span class="line">    win_no_prefer_redirects=<span class="literal">False</span>,</span><br><span class="line">    win_private_assemblies=<span class="literal">False</span>,</span><br><span class="line">    cipher=block_cipher,</span><br><span class="line">    noarchive=<span class="literal">False</span>,</span><br><span class="line">)</span><br><span class="line">pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)</span><br><span class="line"></span><br><span class="line">exe = EXE(</span><br><span class="line">    pyz,</span><br><span class="line">    a.scripts,</span><br><span class="line">    a.binaries,</span><br><span class="line">    a.zipfiles,</span><br><span class="line">    a.datas,</span><br><span class="line">    [],</span><br><span class="line">    name=<span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    debug=<span class="literal">False</span>,</span><br><span class="line">    bootloader_ignore_signals=<span class="literal">False</span>,</span><br><span class="line">    strip=<span class="literal">False</span>,</span><br><span class="line">    upx=<span class="literal">True</span>,</span><br><span class="line">    upx_exclude=[],</span><br><span class="line">    runtime_tmpdir=<span class="literal">None</span>,</span><br><span class="line">    console=<span class="literal">True</span>,</span><br><span class="line">    disable_windowed_traceback=<span class="literal">False</span>,</span><br><span class="line">    argv_emulation=<span class="literal">False</span>,</span><br><span class="line">    target_arch=<span class="literal">None</span>,</span><br><span class="line">    codesign_identity=<span class="literal">None</span>,</span><br><span class="line">    entitlements_file=<span class="literal">None</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ps:<code>datas=[]</code>中的资源路径需要和脚本文件同级</p>
<h6 id="三、修改脚本中的引用路径"><a href="#三、修改脚本中的引用路径" class="headerlink" title="三、修改脚本中的引用路径"></a>三、修改脚本中的引用路径</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.path.dirname(__file__)+<span class="string">&#x27;/目录/图片.png&#x27;</span></span><br></pre></td></tr></table></figure>
<h6 id="四、再次打包"><a href="#四、再次打包" class="headerlink" title="四、再次打包"></a>四、再次打包</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller test.spec</span><br></pre></td></tr></table></figure>
<p>ps:这次不用加 -F</p>
<h2 id="使用Pyinstaller解包"><a href="#使用Pyinstaller解包" class="headerlink" title="使用Pyinstaller解包"></a>使用Pyinstaller解包</h2><h3 id="1-可执行文件-exe解包"><a href="#1-可执行文件-exe解包" class="headerlink" title="1.可执行文件.exe解包"></a>1.可执行文件.exe解包</h3><p>解包使用<code>pyinstxtractor</code>工具</p>
<p>Github地址: <a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor" title="pyinstxtractor">pyinstxtractor</a></p>
<h4 id="pyinstxtractor文件备份"><a href="#pyinstxtractor文件备份" class="headerlink" title="pyinstxtractor文件备份"></a>pyinstxtractor文件备份</h4><a href="/2022/10/21/pyinstxtractor/" title="pyinstxtractor">pyinstxtractor</a>
<p>下载文件后对要解包的文件执行<code>cmd</code>命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pyinstxtractor.py test.exe</span><br></pre></td></tr></table></figure>
<h3 id="2-反编译-pyc文件"><a href="#2-反编译-pyc文件" class="headerlink" title="2.反编译.pyc文件"></a>2.反编译<code>.pyc</code>文件</h3><h4 id="安装uncompyle6"><a href="#安装uncompyle6" class="headerlink" title="安装uncompyle6"></a>安装uncompyle6</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install uncompyle6</span><br></pre></td></tr></table></figure>
<h4 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 test.pyc &gt; test.py</span><br></pre></td></tr></table></figure>
<p>ps:<code>test.pyc由解包生成</code></p>

      
    </div>
  </div>
  
</article>



  
    <article id="post-油猴的进阶操作" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/19/%E6%B2%B9%E7%8C%B4%E7%9A%84%E8%BF%9B%E9%98%B6%E6%93%8D%E4%BD%9C/" class="article-date">
  <time class="dt-published" datetime="2022-06-19T09:09:45.000Z" itemprop="datePublished">2022-06-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/06/19/%E6%B2%B9%E7%8C%B4%E7%9A%84%E8%BF%9B%E9%98%B6%E6%93%8D%E4%BD%9C/">油猴的进阶操作</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="ajax-hook请求代理的使用"><a href="#ajax-hook请求代理的使用" class="headerlink" title="ajax-hook请求代理的使用"></a>ajax-hook请求代理的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// @require      https://unpkg.com/ajax-hook@2.0.3/dist/ajaxhook.min.js</span><br><span class="line">// @run-at       document-start</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ah.proxy(&#123;</span><br><span class="line">    //请求发起前进入</span><br><span class="line">    onRequest: (config, handler) =&gt; &#123;</span><br><span class="line">        console.log(config.url)</span><br><span class="line">        handler.next(config);</span><br><span class="line">    &#125;,</span><br><span class="line">    //请求发生错误时进入，比如超时；注意，不包括http状态码错误，如404仍然会认为请求成功</span><br><span class="line">    onError: (err, handler) =&gt; &#123;</span><br><span class="line">        console.log(err.type)</span><br><span class="line">        handler.next(err)</span><br><span class="line">    &#125;,</span><br><span class="line">    //请求成功后进入</span><br><span class="line">    onResponse: (response, handler) =&gt; &#123;</span><br><span class="line">        console.log(response.response)</span><br><span class="line">        console.log(handler)</span><br><span class="line">        handler.next(response)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="post-ios连线Windows调试safari" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/27/ios%E8%BF%9E%E7%BA%BFWindows%E8%B0%83%E8%AF%95safari/" class="article-date">
  <time class="dt-published" datetime="2022-05-27T14:23:01.000Z" itemprop="datePublished">2022-05-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/05/27/ios%E8%BF%9E%E7%BA%BFWindows%E8%B0%83%E8%AF%95safari/">ios连线Windows调试safari</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="1-安装iTunes"><a href="#1-安装iTunes" class="headerlink" title="1.安装iTunes"></a>1.安装iTunes</h3><p><img src="/images/iTunes.png" alt="iTunes"></p>
<h3 id="2-安装scoop"><a href="#2-安装scoop" class="headerlink" title="2.安装scoop"></a>2.安装scoop</h3><h4 id="步骤-1：在-PowerShell-中打开远程权限"><a href="#步骤-1：在-PowerShell-中打开远程权限" class="headerlink" title="步骤 1：在 PowerShell 中打开远程权限"></a>步骤 1：在 PowerShell 中打开远程权限</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy RemoteSigned -scope CurrentUser;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-2：自定义-Scoop-安装目录"><a href="#步骤-2：自定义-Scoop-安装目录" class="headerlink" title="步骤 2：自定义 Scoop 安装目录"></a>步骤 2：自定义 Scoop 安装目录</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">env</span>:SCOOP=<span class="string">&#x27;Your_Scoop_Path&#x27;</span></span></span><br><span class="line">[Environment]::SetEnvironmentVariable(&#x27;SCOOP&#x27;, $env:SCOOP, &#x27;User&#x27;)</span><br></pre></td></tr></table></figure>
<p>如果跳过该步骤， Scoop 将默认把所有用户安装的 App 和 Scoop 本身置于<code>C:\Users\user_name\scoop</code></p>
<h4 id="步骤-3：下载并安装-Scoop"><a href="#步骤-3：下载并安装-Scoop" class="headerlink" title="步骤 3：下载并安装 Scoop"></a>步骤 3：下载并安装 Scoop</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iwr -useb get.scoop.sh | iex</span><br><span class="line">scoop update</span><br></pre></td></tr></table></figure>
<h4 id="国内镜像"><a href="#国内镜像" class="headerlink" title="国内镜像"></a>国内镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iwr -useb https://gitee.com/glsnames/scoop-installer/raw/master/bin/install.ps1 | iex</span><br><span class="line">scoop config SCOOP_REPO &#x27;https://gitee.com/glsnames/scoop-installer&#x27;</span><br><span class="line">scoop update</span><br></pre></td></tr></table></figure>
<h3 id="3-通过scoop安装-ios-webkit-debug-proxy"><a href="#3-通过scoop安装-ios-webkit-debug-proxy" class="headerlink" title="3.通过scoop安装 ios_webkit_debug_proxy"></a>3.通过scoop安装 ios_webkit_debug_proxy</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add extras</span><br><span class="line">scoop install ios-webkit-debug-proxy</span><br><span class="line">npm install -g vs-libimobile</span><br></pre></td></tr></table></figure>
<h4 id="4-安装最新版本的-remotedebug-ios-webkit-adapter"><a href="#4-安装最新版本的-remotedebug-ios-webkit-adapter" class="headerlink" title="4.安装最新版本的 remotedebug-ios-webkit-adapter"></a>4.安装最新版本的 remotedebug-ios-webkit-adapter</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install remotedebug-ios-webkit-adapter -g</span><br></pre></td></tr></table></figure>
<h4 id="5-在Safari中启用远程调试"><a href="#5-在Safari中启用远程调试" class="headerlink" title="5.在Safari中启用远程调试"></a>5.在Safari中启用远程调试</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">为了显示您的iOS设备，您需要启用启用开发者模式进行调试。</span><br><span class="line"></span><br><span class="line">Iphone =&gt; 设置 =&gt; Safari 浏览器 =&gt; 高级 =&gt; web检查器 =&gt; 启用</span><br></pre></td></tr></table></figure>
<h4 id="6-让您的计算机信任您的iOS设备"><a href="#6-让您的计算机信任您的iOS设备" class="headerlink" title="6.让您的计算机信任您的iOS设备"></a>6.让您的计算机信任您的iOS设备</h4><p><code>将Iphone手机连接电脑，必须点击“信任”，并打开 itunes, 以确保手机连接。</code></p>
<h4 id="7-打开PowerShell，运行以下命令："><a href="#7-打开PowerShell，运行以下命令：" class="headerlink" title="7.打开PowerShell，运行以下命令："></a>7.打开PowerShell，运行以下命令：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">remotedebug_ios_webkit_adapter --port=9000</span><br></pre></td></tr></table></figure>
<h4 id="8-打开chrome-输入网址：-chrome-inspect-devices"><a href="#8-打开chrome-输入网址：-chrome-inspect-devices" class="headerlink" title="8.打开chrome, 输入网址： chrome://inspect/#devices"></a>8.打开chrome, 输入网址： <code>chrome://inspect/#devices</code></h4><p><code>如下图所示，点击 inspect, 即可调试。</code><br><img src="/images/localhost.png" alt="localhost"><br><img src="/images/inspect.png" alt="inspect"></p>
<h2 id="Ps-首次访问需要翻墙-Safari浏览器对变量比较严格-不能直接定义"><a href="#Ps-首次访问需要翻墙-Safari浏览器对变量比较严格-不能直接定义" class="headerlink" title="Ps:首次访问需要翻墙,Safari浏览器对变量比较严格,不能直接定义"></a><code>Ps:首次访问需要翻墙,Safari浏览器对变量比较严格,不能直接定义</code></h2>
      
    </div>
  </div>
  
</article>



  
    <article id="post-油猴的网络请求" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/27/%E6%B2%B9%E7%8C%B4%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" class="article-date">
  <time class="dt-published" datetime="2022-05-27T09:45:16.000Z" itemprop="datePublished">2022-05-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/05/27/%E6%B2%B9%E7%8C%B4%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/">油猴的网络请求</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="AJAX请求参数"><a href="#AJAX请求参数" class="headerlink" title="AJAX请求参数"></a>AJAX请求参数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;url&quot;</span>,              <span class="comment">//网址</span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;post&quot;</span>,           <span class="comment">//请求方式</span></span><br><span class="line">    <span class="attr">data</span>: q,                <span class="comment">//传入的参数 </span></span><br><span class="line">    <span class="attr">headers</span>: header        <span class="comment">//请求头</span></span><br><span class="line">    <span class="attr">xhrFields</span>: &#123;</span><br><span class="line">        <span class="attr">withCredentials</span>: <span class="literal">true</span>   <span class="comment">//设置携带cookies   </span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">result</span>) &#123; <span class="comment">//返回函数</span></span><br><span class="line"></span><br><span class="line">        j = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(result) <span class="comment">//将返回值转为json</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="fetch请求"><a href="#fetch请求" class="headerlink" title="fetch请求"></a>fetch请求</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const Url = &quot;https://kilesa.gitee.io/&quot;</span><br><span class="line">const Data = &#123;</span><br><span class="line">    name: &quot;123&quot;,</span><br><span class="line">    id: 32</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const otherPram = &#123;</span><br><span class="line">    headeers: &#123;</span><br><span class="line">        &quot;content-type&quot;: &quot;application/json&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    body: Data,</span><br><span class="line">    method: &quot;Post&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fetch(Url, otherPram)</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">        return data.json()</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(res =&gt; &#123;</span><br><span class="line">        console.log(res)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(error =&gt; console.log(error))</span><br></pre></td></tr></table></figure>

<h3 id="GM-xmlhttpRequest请求"><a href="#GM-xmlhttpRequest请求" class="headerlink" title="GM_xmlhttpRequest请求"></a>GM_xmlhttpRequest请求</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GM_xmlhttpRequest(&#123;</span><br><span class="line">            method: &#x27;POST&#x27;,</span><br><span class="line">            url: &#x27;https://msg.115.com/?ct=notice&amp;ac=delete&#x27;,</span><br><span class="line">            headers: &#123;</span><br><span class="line">                &quot;cookie&quot;: &quot;&quot;,</span><br><span class="line">                &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            data: &quot;&quot;,</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="GM-addStyle添加Css"><a href="#GM-addStyle添加Css" class="headerlink" title="GM_addStyle添加Css"></a>GM_addStyle添加Css</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GM_addStyle(`.di &#123;</span><br><span class="line">  position:fixed;bottom:0px;</span><br><span class="line">`);</span><br></pre></td></tr></table></figure>

<h3 id="Tampermonkey写入元素"><a href="#Tampermonkey写入元素" class="headerlink" title="Tampermonkey写入元素"></a>Tampermonkey写入元素</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;定位&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;a  class=&quot;btn&quot; id=&quot;dow&quot;&gt;下载&lt;/a&gt;&#x27;</span>);  <span class="comment">//jq版本太低好像不行</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;#dow&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击事件添加成功!&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Tampermonkey的noConflict导入"><a href="#Tampermonkey的noConflict导入" class="headerlink" title="Tampermonkey的noConflict导入"></a>Tampermonkey的noConflict导入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.jq = $.noConflict(true);</span><br></pre></td></tr></table></figure>

<h3 id="一次性打开网页上的超链接"><a href="#一次性打开网页上的超链接" class="headerlink" title="一次性打开网页上的超链接"></a>一次性打开网页上的超链接</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.tr3.t_one td h3 a&quot;</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">element,index</span>) &#123;<span class="variable language_">window</span>.<span class="title function_">open</span>(element,index)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//document.querySelectorAll(&quot;.tr3.t_one td h3 a&quot;)  .为选取class名标签  </span></span><br><span class="line"><span class="comment">//td h3 a 为xpath  forEach为循环  Window.open不用index命名只能打开一个</span></span><br></pre></td></tr></table></figure>
      
    </div>
  </div>
  
</article>



  
    <article id="`hexo-hexo挂载本地资源" class="h-entry article article-type-`hexo" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/12/hexo%E6%8C%82%E8%BD%BD%E6%9C%AC%E5%9C%B0%E8%B5%84%E6%BA%90/" class="article-date">
  <time class="dt-published" datetime="2022-02-12T11:31:40.000Z" itemprop="datePublished">2022-02-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/12/hexo%E6%8C%82%E8%BD%BD%E6%9C%AC%E5%9C%B0%E8%B5%84%E6%BA%90/">hexo挂载本地资源</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="使用images挂载"><a href="#使用images挂载" class="headerlink" title="使用images挂载"></a>使用images挂载</h2><p><font size=3><strong>资源（Asset）代表 source 文件夹中除了文章以外的所有文件，例如图片、CSS、JS 文件等。比方说，如果你的Hexo项目中只有少量图片，那最简单的方法就是将它们放在 source/images 文件夹中。然后通过类似于<code>![](/images/image.jpg)</code> 的方法访问它们。</strong></font></p>
<h2 id="直接使用Github的相对路径"><a href="#直接使用Github的相对路径" class="headerlink" title="直接使用Github的相对路径"></a>直接使用Github的相对路径</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="number">2</span>](/images/<span class="number">2.</span>png)</span><br></pre></td></tr></table></figure>

<h2 id="使用post-asset-folder"><a href="#使用post-asset-folder" class="headerlink" title="使用post_asset_folder"></a>使用post_asset_folder</h2><h4 id="创建一个与文档同名的文件夹，之后挂载文件"><a href="#创建一个与文档同名的文件夹，之后挂载文件" class="headerlink" title="创建一个与文档同名的文件夹，之后挂载文件"></a>创建一个与文档同名的文件夹，之后挂载文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img 图片 描述 %&#125;</span><br></pre></td></tr></table></figure>
<p>ps:<code>asset_img指代图片,post_link指代文章</code></p>
<h4 id="在-config-yml中将post-asset-folder设置为true会在使用hexo-new创建文章时自动创建文件夹"><a href="#在-config-yml中将post-asset-folder设置为true会在使用hexo-new创建文章时自动创建文件夹" class="headerlink" title="在_config.yml中将post_asset_folder设置为true会在使用hexo new创建文章时自动创建文件夹"></a>在<code>_config.yml</code>中将<code>post_asset_folder</code>设置为<code>true</code>会在使用<code>hexo new</code>创建文章时自动创建文件夹</h4><h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">官方文档</a></h2>
      
    </div>
  </div>
  
</article>



  
    <article id="post-GoLand激活" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/12/GoLand%E6%BF%80%E6%B4%BB/" class="article-date">
  <time class="dt-published" datetime="2022-02-12T08:47:27.000Z" itemprop="datePublished">2022-02-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/02/12/GoLand%E6%BF%80%E6%B4%BB/">GoLand激活</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="1-进入goland得初始化界面"><a href="#1-进入goland得初始化界面" class="headerlink" title="1.进入goland得初始化界面"></a>1.进入goland得初始化界面</h3><p><img src="/images/1.png" alt="1"></p>
<h3 id="2-点击插件-plugins"><a href="#2-点击插件-plugins" class="headerlink" title="2.点击插件 plugins"></a>2.点击插件 plugins</h3><p><img src="/images/2.png" alt="2"></p>
<h3 id="3-安装IDE-Eval-Reset，就可以了。"><a href="#3-安装IDE-Eval-Reset，就可以了。" class="headerlink" title="3.安装IDE Eval Reset，就可以了。"></a>3.安装IDE Eval Reset，就可以了。</h3><h3 id="4-安装得-IDE-Eval-Reset是第三方插件库，所以我们再安装之前，需要先添加第三方插件地址"><a href="#4-安装得-IDE-Eval-Reset是第三方插件库，所以我们再安装之前，需要先添加第三方插件地址" class="headerlink" title="4.安装得 IDE Eval Reset是第三方插件库，所以我们再安装之前，需要先添加第三方插件地址"></a>4.安装得 IDE Eval Reset是第三方插件库，所以我们再安装之前，需要先添加第三方插件地址</h3><h4 id="（1）点击设置按钮"><a href="#（1）点击设置按钮" class="headerlink" title="（1）点击设置按钮"></a>（1）点击设置按钮</h4><p><img src="/images/3.png" alt="3"></p>
<h4 id="（2）选择设置下面得插件管理市场-manage-plugin-repositories"><a href="#（2）选择设置下面得插件管理市场-manage-plugin-repositories" class="headerlink" title="（2）选择设置下面得插件管理市场 manage plugin repositories"></a>（2）选择设置下面得插件管理市场 manage plugin repositories</h4><p><img src="/images/4.png" alt="4"></p>
<h4 id="3-添加三方插件地址：https-plugins-zhile-io，点击ok，就可以直接安装IDE-Eval-Reset"><a href="#3-添加三方插件地址：https-plugins-zhile-io，点击ok，就可以直接安装IDE-Eval-Reset" class="headerlink" title="(3)添加三方插件地址：https://plugins.zhile.io，点击ok，就可以直接安装IDE Eval Reset"></a>(3)添加三方插件地址：<code>https://plugins.zhile.io</code>，点击ok，就可以直接安装IDE Eval Reset</h4><p><img src="/images/5.png" alt="5"></p>
<h3 id="5-如果你得goland已经过了试用期，则还会一直弹出让你激活得提示，但是编辑器是可以打开的，这时候，我们需要进入goland编辑器，重置试用期即可，而且设置成每次打开就重置，就不会出现一直让你激活得提示了。"><a href="#5-如果你得goland已经过了试用期，则还会一直弹出让你激活得提示，但是编辑器是可以打开的，这时候，我们需要进入goland编辑器，重置试用期即可，而且设置成每次打开就重置，就不会出现一直让你激活得提示了。" class="headerlink" title="5.如果你得goland已经过了试用期，则还会一直弹出让你激活得提示，但是编辑器是可以打开的，这时候，我们需要进入goland编辑器，重置试用期即可，而且设置成每次打开就重置，就不会出现一直让你激活得提示了。"></a>5.如果你得goland已经过了试用期，则还会一直弹出让你激活得提示，但是编辑器是可以打开的，这时候，我们需要进入goland编辑器，重置试用期即可，而且设置成每次打开就重置，就不会出现一直让你激活得提示了。</h3><h4 id="（1）进入goland，点击help下面得eval-reset"><a href="#（1）进入goland，点击help下面得eval-reset" class="headerlink" title="（1）进入goland，点击help下面得eval reset"></a>（1）进入goland，点击help下面得eval reset</h4><p><img src="/images/6.png" alt="6"></p>
<h4 id="（2）出现如下所示："><a href="#（2）出现如下所示：" class="headerlink" title="（2）出现如下所示："></a>（2）出现如下所示：</h4><p><img src="/images/7.png" alt="7"></p>
<h4 id="（3）勾选上图中右下角位置得-auto-reset-before-per-restart，然后点击reset即可。之后出现提示如下所示："><a href="#（3）勾选上图中右下角位置得-auto-reset-before-per-restart，然后点击reset即可。之后出现提示如下所示：" class="headerlink" title="（3）勾选上图中右下角位置得 auto reset before per restart，然后点击reset即可。之后出现提示如下所示："></a>（3）勾选上图中右下角位置得 auto reset before per restart，然后点击reset即可。之后出现提示如下所示：</h4><p><img src="/images/8.png" alt="8"></p>
<h4 id="（4）点击yes之后，你得goland编辑器就会重新启动，然后就可以使用了。"><a href="#（4）点击yes之后，你得goland编辑器就会重新启动，然后就可以使用了。" class="headerlink" title="（4）点击yes之后，你得goland编辑器就会重新启动，然后就可以使用了。"></a>（4）点击yes之后，你得goland编辑器就会重新启动，然后就可以使用了。</h4><h3 id="6-以后再也不会出现提示了。"><a href="#6-以后再也不会出现提示了。" class="headerlink" title="6.以后再也不会出现提示了。"></a>6.以后再也不会出现提示了。</h3><h3 id="ps-原地址-记录一下防止忘记"><a href="#ps-原地址-记录一下防止忘记" class="headerlink" title="ps:原地址,记录一下防止忘记"></a>ps:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lxz123/p/15189227.html" title="原地址">原地址</a>,记录一下防止忘记</h3>
      
    </div>
  </div>
  
</article>



  
    <article id="post-油猴的基本使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/26/%E6%B2%B9%E7%8C%B4%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2021-09-26T07:30:22.000Z" itemprop="datePublished">2021-09-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/26/%E6%B2%B9%E7%8C%B4%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">油猴的基本使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="油猴脚本的学习"><a href="#油猴脚本的学习" class="headerlink" title="油猴脚本的学习"></a>油猴脚本的学习</h2><table>
<thead>
<tr>
<th>关键词</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>@name</td>
<td>脚本的名字</td>
</tr>
<tr>
<td>@namespace</td>
<td>脚本的作用域</td>
</tr>
<tr>
<td>@match</td>
<td>脚本的作用域名</td>
</tr>
<tr>
<td>@grant</td>
<td>脚本的权限</td>
</tr>
<tr>
<td>@version</td>
<td>脚本的版本号</td>
</tr>
<tr>
<td>@author</td>
<td>脚本的作者</td>
</tr>
<tr>
<td>@description</td>
<td>脚本的描述</td>
</tr>
<tr>
<td>@require</td>
<td>导入JS文件</td>
</tr>
</tbody></table>
<h6 id="ps-grant设置为none就是直接运行在前端页面中-否则就是运行在一个沙盒环境-需要使用unsafeWindow去操作前端的元素。"><a href="#ps-grant设置为none就是直接运行在前端页面中-否则就是运行在一个沙盒环境-需要使用unsafeWindow去操作前端的元素。" class="headerlink" title="ps:grant设置为none就是直接运行在前端页面中,否则就是运行在一个沙盒环境,需要使用unsafeWindow去操作前端的元素。"></a>ps:grant设置为none就是直接运行在前端页面中,否则就是运行在一个沙盒环境,需要使用unsafeWindow去操作前端的元素。</h6><h4 id="这是初始函数简写"><a href="#这是初始函数简写" class="headerlink" title="这是初始函数简写"></a>这是初始函数简写</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function">()=&gt;</span>&#123;&#125;)()</span><br></pre></td></tr></table></figure>

<h4 id="设置百度的第三个关键热词为红色"><a href="#设置百度的第三个关键热词为红色" class="headerlink" title="设置百度的第三个关键热词为红色"></a>设置百度的第三个关键热词为红色</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;#hotsearch-content-wrapper li a span&quot;</span>)[<span class="number">13</span>].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;red&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="所有热词设置为红色"><a href="#所有热词设置为红色" class="headerlink" title="所有热词设置为红色"></a>所有热词设置为红色</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#hotsearch-content-wrapper li a span&quot;</span>).<span class="title function_">css</span>(&#123;<span class="string">&quot;color&quot;</span>:<span class="string">&quot;red&quot;</span>&#125;);                    </span><br></pre></td></tr></table></figure>

<h4 id="把百度的新闻修改成旧闻"><a href="#把百度的新闻修改成旧闻" class="headerlink" title="把百度的新闻修改成旧闻"></a>把百度的新闻修改成旧闻</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#s-top-left &gt; a:nth-child(1)&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;旧闻&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="将搜索框的placeholder改为油猴脚本"><a href="#将搜索框的placeholder改为油猴脚本" class="headerlink" title="将搜索框的placeholder改为油猴脚本"></a>将搜索框的placeholder改为油猴脚本</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#kw&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;placeholder&quot;</span>,<span class="string">&quot;油猴脚本&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="设置为按下-键就打开谷歌翻译"><a href="#设置为按下-键就打开谷歌翻译" class="headerlink" title="设置为按下~键就打开谷歌翻译"></a>设置为按下~键就打开谷歌翻译</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&#x27;keypress&#x27;</span>,<span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(e.<span class="property">which</span> == <span class="number">96</span>) &#123;</span><br><span class="line">        $(location).<span class="title function_">attr</span>(<span class="string">&#x27;href&#x27;</span>,<span class="string">&#x27;https://translate.google.cn/&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="导入JQ"><a href="#导入JQ" class="headerlink" title="导入JQ"></a>导入JQ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @require     https://code.jquery.com/jquery-3.6.0.min.js</span></span><br></pre></td></tr></table></figure>

<h4 id="在控制台导入JQ"><a href="#在控制台导入JQ" class="headerlink" title="在控制台导入JQ"></a>在控制台导入JQ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> importJs=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">importJs.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;text/javascript&quot;</span>);</span><br><span class="line">importJs.<span class="title function_">setAttribute</span>(<span class="string">&quot;src&quot;</span>, <span class="string">&#x27;https://code.jquery.com/jquery-3.1.1.min.js&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(importJs);</span><br></pre></td></tr></table></figure>

<h4 id="用JSON导出Excel表格"><a href="#用JSON导出Excel表格" class="headerlink" title="用JSON导出Excel表格"></a>用JSON导出Excel表格</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; titleList 传入的标题数据和需要导出的key </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; dataSource 传入的数据源</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">String</span>&#125; fileName 导出的文件名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tableToExcel</span>(<span class="params">titleList = [], dataSource = [], fileName = <span class="string">&quot;&quot;</span></span>) &#123;</span><br><span class="line">    <span class="comment">//要导出的标题</span></span><br><span class="line">    <span class="comment">// 处理数据 这样做是为了在很多数据的时候 导出自己想要的数据</span></span><br><span class="line">    <span class="keyword">let</span> newDataSource = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; dataSource.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> tep = &#123;&#125;;</span><br><span class="line">        titleList.<span class="title function_">forEach</span>(<span class="function">(<span class="params">&#123; key &#125;</span>) =&gt;</span> &#123; <span class="comment">//key是colums中的每个key(name..age...)</span></span><br><span class="line">            tep[key] = dataSource[i][key]</span><br><span class="line">        &#125;)</span><br><span class="line">        newDataSource.<span class="title function_">push</span>(tep)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; titleList.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        str += <span class="string">`&lt;td&gt;<span class="subst">$&#123;titleList[i].title + <span class="string">&#x27;\t&#x27;</span>&#125;</span>&lt;/td&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    str += <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    str += <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; newDataSource.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">in</span> newDataSource[i]) &#123;</span><br><span class="line">            <span class="keyword">let</span> news = newDataSource[i][item] ? newDataSource[i][item] : <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="comment">//style=&quot;mso-number-format:\&#x27;@\&#x27;&quot; =&gt;excel科学计数</span></span><br><span class="line">            <span class="comment">//\t制表符 tab到下一行</span></span><br><span class="line">            str += <span class="string">`&lt;td style=&quot;mso-number-format:\&#x27;@\&#x27;&quot;&gt;<span class="subst">$&#123;news + <span class="string">&#x27;\t&#x27;</span>&#125;</span>&lt;/td&gt;`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        str += <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> uri = <span class="string">&#x27;data:application/vnd.ms-excel;base64,&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> template = <span class="string">`&lt;html xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot; </span></span><br><span class="line"><span class="string">    xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot; </span></span><br><span class="line"><span class="string">    xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;&lt;meta charset=&quot;UTF-8&quot;&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;&lt;x:ExcelWorkbook&gt;&lt;x:ExcelWorksheets&gt;&lt;x:ExcelWorksheet&gt;</span></span><br><span class="line"><span class="string">      &lt;x:Name&gt;<span class="subst">$&#123;fileName&#125;</span>&lt;/x:Name&gt;</span></span><br><span class="line"><span class="string">      &lt;x:WorksheetOptions&gt;&lt;x:DisplayGridlines/&gt;&lt;/x:WorksheetOptions&gt;&lt;/x:ExcelWorksheet&gt;</span></span><br><span class="line"><span class="string">      &lt;/x:ExcelWorksheets&gt;&lt;/x:ExcelWorkbook&gt;&lt;/xml&gt;&lt;![endif]--&gt;</span></span><br><span class="line"><span class="string">      &lt;/head&gt;&lt;body&gt;&lt;table&gt;<span class="subst">$&#123;str&#125;</span>&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;`</span>;</span><br><span class="line">    <span class="keyword">var</span> base64 = <span class="keyword">function</span> (<span class="params">s</span>) &#123; <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="title function_">btoa</span>(<span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(s))) &#125;</span><br><span class="line">    <span class="keyword">var</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    link.<span class="property">href</span> = uri + <span class="title function_">base64</span>(template);</span><br><span class="line">    link.<span class="property">download</span> = fileName ? fileName + <span class="string">&quot;.xls&quot;</span> : <span class="string">&quot;数据.xls&quot;</span>;<span class="comment">//当前下载的excel名称</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link);</span><br><span class="line">    link.<span class="property">innerHTML</span> = <span class="string">&quot;点击下载&quot;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(template)))</span><br><span class="line">    link.<span class="title function_">click</span>();</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="暂时还不知道为什么只能直接写到油猴的一个文件内"><a href="#暂时还不知道为什么只能直接写到油猴的一个文件内" class="headerlink" title="暂时还不知道为什么只能直接写到油猴的一个文件内"></a>暂时还不知道为什么只能直接写到油猴的一个文件内</h6>
      
    </div>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/" rel="tag">Github</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tampermonkey/" rel="tag">Tampermonkey</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/" rel="tag">ios</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 12.5px;">Docker</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Golang/" style="font-size: 20px;">Golang</a> <a href="/tags/Linux/" style="font-size: 12.5px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/Tampermonkey/" style="font-size: 15px;">Tampermonkey</a> <a href="/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/nodejs/" style="font-size: 12.5px;">nodejs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/21/pyinstxtractor/">pyinstxtractor</a>
          </li>
        
          <li>
            <a href="/2022/10/16/%E7%BD%91%E9%A1%B5%E4%B8%8A%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%8C%89%E9%92%AE/">网页上添加一个按钮</a>
          </li>
        
          <li>
            <a href="/2022/08/16/python%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F/">python自动执行程序</a>
          </li>
        
          <li>
            <a href="/2022/08/15/python%E6%89%93%E5%8C%85%E4%B8%8E%E8%A7%A3%E5%8C%85exe/">python打包与解包exe</a>
          </li>
        
          <li>
            <a href="/2022/06/19/%E6%B2%B9%E7%8C%B4%E7%9A%84%E8%BF%9B%E9%98%B6%E6%93%8D%E4%BD%9C/">油猴的进阶操作</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 鱼糕先生<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">文章</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>